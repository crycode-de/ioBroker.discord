{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["import 'source-map-support/register';\n\nimport { isDeepStrictEqual } from 'node:util';\n\nimport { boundMethod } from 'autobind-decorator';\n\nimport {\n  Adapter,\n  AdapterOptions,\n  EXIT_CODES,\n} from '@iobroker/adapter-core';\n\nimport {\n  Client,\n  Collection,\n  Guild,\n  GuildBasedChannel,\n  GuildMember,\n  Intents,\n  Message,\n  MessageOptions,\n  NonThreadGuildBasedChannel,\n  Permissions,\n  Presence,\n  PresenceData,\n  PresenceStatusData,\n  Snowflake,\n  User,\n  VoiceState,\n} from 'discord.js';\n\nimport {\n  CommandObjectConfig,\n  DiscordAdapterSlashCommands,\n} from './commands';\nimport {\n  SetBotPresenceOptions,\n  Text2commandMessagePayload,\n  VALID_ACTIVITY_TYPES,\n  VALID_PRESENCE_STATUS_DATA,\n  ValidActivityType,\n  JsonServersMembersObj,\n  JsonServersChannelsObj,\n  JsonUsersObj,\n  UpdateUserPresenceResult,\n  JsonMessageObj,\n  CheckAuthorizationOpts,\n  SendToActionSendPayload,\n  SendToActionEditMessagePayload,\n  MessageIdentifier,\n  SendToActionAwaitMessageReactionPayload,\n  SendToActionAddReactionPayload,\n  SendToActionServerIdentifier,\n  SendToActionSendCustomCommandReplyPayload,\n  SendToActionChannelIdentifier,\n  SendToActionServerMemberIdentifier,\n  SendToActionUserIdentifier,\n} from './lib/definitions';\nimport { i18n } from './lib/i18n';\nimport {\n  getBasenameFromFilePathOrUrl,\n  getBufferAndNameFromBase64String,\n} from './lib/utils';\n\nconst LOGIN_WAIT_TIMES = <const>[\n  0, // none - first try!\n  5000, // 5 sek\n  10000, // 10 sek\n  30000, // 30 sek\n  60000, // 1 min\n  120000, // 2 min\n  120000, // 2 min\n  300000, // 5 min\n  300000, // 5 min\n  300000, // 5 min\n  600000, // 10 min\n];\n\n/**\n * ioBroker.discord adapter\n */\nclass DiscordAdapter extends Adapter {\n\n  /**\n   * Local cache for `info.connection` state.\n   */\n  private infoConnected: boolean = false;\n\n  /**\n   * Instance of the discord client.\n   */\n  public client: Client | null = null;\n\n  /**\n   * Set of state IDs where received discord messages will be stored to.\n   * Used to identify target states for received discord messages.\n   */\n  private messageReceiveStates: Set<string> = new Set();\n\n  /**\n   * Set user IDs known to set up.\n   * Used to check if the user objects are created on some events.\n   */\n  private knownUsers: Set<Snowflake> = new Set();\n\n  /**\n   * Set of objects from this instance with text2command enabled.\n   */\n  private text2commandObjects: Set<string> = new Set();\n\n  /**\n   * Cache for `extendObjectCache(...)` calls to extend objects only when changed.\n   */\n  private extendObjectCache: Collection<string, ioBroker.PartialObject> = new Collection();\n\n  /**\n   * Cache for `.json` states.\n   */\n  private jsonStateCache: Collection<string, JsonServersMembersObj | JsonServersChannelsObj | JsonUsersObj | JsonMessageObj> = new Collection();\n\n  /**\n   * Instance of the slash commands handler class.\n   */\n  private discordSlashCommands: DiscordAdapterSlashCommands;\n\n  /**\n   * Flag if the initial setup of the custom object configurations is done or not.\n   * While not done, custom object configuration changes will not trigger a\n   * slash commands registration automatically.\n   */\n  public initialCustomObjectSetupDone: boolean = false;\n\n  /**\n   * Flag if the adapter is unloaded or is unloading.\n   * Used to check this in some async operations.\n   */\n  public unloaded: boolean = false;\n\n  public constructor(options: Partial<AdapterOptions> = {}) {\n    super({\n      ...options,\n      name: 'discord',\n    });\n\n    this.discordSlashCommands = new DiscordAdapterSlashCommands(this);\n\n    this.on('ready', this.onReady);\n    this.on('stateChange', this.onStateChange);\n    this.on('objectChange', this.onObjectChange);\n    this.on('message', this.onMessage);\n    this.on('unload', this.onUnload);\n  }\n\n  /**\n   * Is called when databases are connected and adapter received configuration.\n   */\n  @boundMethod\n  private async onReady(): Promise<void> {\n\n    // Reset the connection indicator during startup\n    await this.setInfoConnectionState(false, true);\n\n    // try to get the system language\n    const systemConfig = await this.getForeignObjectAsync('system.config');\n    i18n.language = systemConfig?.common.language || 'en';\n    i18n.isFloatComma = systemConfig?.common.isFloatComma || false;\n\n    // validate config\n    if (typeof this.config.token !== 'string' || !this.config.token.match(/^[0-9a-zA-Z-_]{24}\\.[0-9a-zA-Z-_]{6}\\.[0-9a-zA-Z-_]{27,38}$/)) {\n      this.log.error(`No or invalid token!`);\n      return;\n    }\n    if (!Array.isArray(this.config.authorizedUsers)) {\n      this.config.authorizedUsers = [];\n    }\n    if (!Array.isArray(this.config.authorizedServerRoles)) {\n      this.config.authorizedServerRoles = [];\n    }\n    if (!this.config.enableAuthorization) {\n      this.log.info('Authorization is disabled, so any user is able to interact with the bot. You should only disable authorization if you trust all users on any server where the bot is on.');\n    }\n    if (this.config.enableAuthorization && this.config.authorizedUsers.length === 0 && this.config.authorizedServerRoles.length === 0) {\n      this.log.info('Authorization is enabled but no authorized users are defined!');\n    }\n    if (this.config.enableCustomCommands && !Array.isArray(this.config.customCommands)) {\n      this.config.customCommands = [];\n    }\n    this.config.reactOnMentionsEmoji = this.config.reactOnMentionsEmoji?.trim() || '\uD83D\uDC4D';\n\n    // setup generic dynamic objects (most objects will be set up in `updateGuilds` method)\n    if (this.config.enableRawStates) {\n      await this.extendObjectAsync('raw', {\n        type: 'channel',\n        common: {\n          name: i18n.getStringOrTranslated('Raw data'),\n        },\n        native: {},\n      });\n      await Promise.all([\n        this.extendObjectAsync('raw.interactionJson', {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Last interaction JSON data'),\n            role: 'json',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsync('raw.messageJson', {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Last message JSON data'),\n            role: 'json',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n      ]);\n    } else {\n      await this.delObjectAsync('raw', { recursive: true });\n    }\n\n    if (this.config.enableCustomCommands) {\n      await this.extendObjectAsync('slashCommands', {\n        type: 'channel',\n        common: {\n          name: i18n.getStringOrTranslated('Custom Discord slash commands'),\n        },\n        native: {},\n      });\n    } else {\n      await this.delObjectAsync('slashCommands', { recursive: true });\n    }\n\n    // setup the discord client\n    this.client = new Client({\n      intents: [\n        Intents.FLAGS.GUILDS,\n        Intents.FLAGS.GUILD_MEMBERS,\n        Intents.FLAGS.GUILD_MESSAGES,\n        Intents.FLAGS.GUILD_MESSAGE_REACTIONS,\n        Intents.FLAGS.GUILD_MESSAGE_TYPING,\n        Intents.FLAGS.GUILD_PRESENCES,\n        Intents.FLAGS.DIRECT_MESSAGES,\n        Intents.FLAGS.DIRECT_MESSAGE_REACTIONS,\n        Intents.FLAGS.DIRECT_MESSAGE_TYPING,\n        Intents.FLAGS.GUILD_VOICE_STATES,\n      ],\n      partials: [\n        'CHANNEL', // needed for DMs\n      ],\n    });\n\n    this.client.on('ready', this.onClientReady);\n\n    if (this.log.level === 'silly') {\n      this.client.on('debug', (message) => this.log.silly(`discordjs: ${message}`));\n    }\n    this.client.on('warn', (message) => this.log.warn(`Discord client warning: ${message}`));\n    this.client.on('error', (err) => this.log.error(`Discord client error: ${err.toString()}`));\n    this.client.on('rateLimit', (rateLimitData) => this.log.debug(`Discord client rate limit hit: ${JSON.stringify(rateLimitData)}`)); // rate limit event is just a information - discord.js handels rate limits\n    this.client.on('invalidRequestWarning', (invalidRequestWarningData) => this.log.warn(`Discord client invalid request warning: ${JSON.stringify(invalidRequestWarningData)}`));\n\n    this.client.on('invalidated', () => {\n      this.log.warn('Discord client session invalidated');\n      this.setInfoConnectionState(false);\n    });\n\n    this.client.on('shardError', (err) => {\n      // discord.js internally handles websocket errors and reconnects\n      // this is just for some logging\n      this.log.warn(`Discord client websocket error: ${err.toString()}`);\n      this.setInfoConnectionState(false);\n    });\n    this.client.on('shardReady', (shardId) => {\n      // discord.js websocket is ready (connected)\n      this.log.info(`Discord client websocket connected (shardId:${shardId})`);\n      this.setInfoConnectionState(true);\n      this.setBotPresence();\n    });\n    this.client.on('shardResume', (shardId, replayedEvents) => this.log.debug(`Discord client websocket resume (shardId:${shardId} replayedEvents:${replayedEvents})`));\n    this.client.on('shardDisconnect', (event, shardId) => this.log.debug(`Discord client websocket disconnect (shardId:${shardId} ${event.reason})`));\n    this.client.on('shardReconnecting', (shardId) => this.log.debug(`Discord client websocket reconnecting (shardId:${shardId})`));\n    this.client.on('shardError', (err, shardId) => {\n      this.log.error(`Discord client websocket error (shardId:${shardId}) ${err}`);\n      this.terminate('Discord client websocket error', EXIT_CODES.ADAPTER_REQUESTED_TERMINATION);\n    });\n\n    this.client.on('messageCreate', this.onClientMessageCreate);\n\n    if (this.config.dynamicServerUpdates) {\n      this.client.on('channelCreate', () => this.updateGuilds());\n      this.client.on('channelDelete', () => this.updateGuilds());\n      this.client.on('channelUpdate', () => this.updateGuilds());\n      this.client.on('guildCreate', () => this.updateGuilds());\n      this.client.on('guildDelete', () => this.updateGuilds());\n      this.client.on('guildUpdate', () => this.updateGuilds());\n      this.client.on('guildMemberAdd', () => this.updateGuilds());\n      this.client.on('guildMemberRemove', () => this.updateGuilds());\n      this.client.on('roleCreate', () => this.updateGuilds());\n      this.client.on('roleDelete', () => this.updateGuilds());\n      this.client.on('roleUpdate', () => this.updateGuilds());\n      this.client.on('userUpdate', () => this.updateGuilds());\n    }\n\n    if (this.config.observeUserPresence) {\n      this.client.on('presenceUpdate', (_oldPresence, newPresence) => { this.updateUserPresence(newPresence.userId, newPresence); });\n    }\n\n    if (this.config.observeUserVoiceState) {\n      this.client.on('voiceStateUpdate', this.onClientVoiceStateUpdate);\n    }\n\n    // init commands instance - need to be done after discord client setup\n    this.discordSlashCommands.onReady();\n\n    // subscribe needed states and objects\n    this.subscribeStates('servers.*.channels.*.send');\n    this.subscribeStates('servers.*.channels.*.sendFile');\n    this.subscribeStates('servers.*.channels.*.sendReply');\n    this.subscribeStates('servers.*.channels.*.sendReaction');\n    this.subscribeStates('users.*.send');\n    this.subscribeStates('users.*.sendFile');\n    this.subscribeStates('users.*.sendReply');\n    this.subscribeStates('users.*.sendReaction');\n    this.subscribeStates('servers.*.members.*.voiceDisconnect');\n    this.subscribeStates('servers.*.members.*.voiceServerMute');\n    this.subscribeStates('servers.*.members.*.voiceServerDeaf');\n    this.subscribeStates('slashCommands.*.sendReply');\n    this.subscribeStates('bot.*');\n    this.subscribeForeignObjects('*'); // needed to handle custom object configs\n\n    // initially get all objects with custom config\n    this.log.debug('Get all objects with custom config ...');\n    const view = await this.getObjectViewAsync('system', 'custom', {});\n    if (view?.rows) {\n      for (const item of view.rows) {\n        await this.setupObjCustom(item.id, item.value?.[this.namespace]);\n      }\n    }\n    this.log.debug('Getting all objects with custom config done');\n\n    // remember that the initial setup of the custom objects is done\n    this.initialCustomObjectSetupDone = true;\n\n    // try to log in the client, terminate if this was not successfull\n    if (!await this.loginClient()) {\n      this.terminate('No connection to Discord', EXIT_CODES.ADAPTER_REQUESTED_TERMINATION);\n      return; // needed!\n    }\n\n    // register discord commands if login was successfull\n    await this.discordSlashCommands.registerSlashCommands();\n  }\n\n  /**\n   * Try to log in the discord client.\n   *\n   * This will also handle network related errors.\n   * In case of networt related errors this will retry the login after some time.\n   * The wait time before each retry will be increased for each try, as defined\n   * in `LOGIN_WAIT_TIMES`.\n   * @param tryNr Number of the login try. Should be `0` when login process is started and is increased internally in each try.\n   * @returns Promise which resolves to `true` if logged in, `false` otherwise.\n   */\n  private async loginClient (tryNr: number = 0): Promise<boolean> {\n    if (!this.client || this.unloaded) {\n      return false;\n    }\n\n    try {\n      await this.client.login(this.config.token);\n      return true;\n    } catch (err) {\n      if (err instanceof Error) {\n        this.log.error(`Discord login error: ${err.toString()}`);\n        if (err.name === 'AbortError') {\n          // AbortError is a result of network errors ... retry\n          tryNr++;\n          if (tryNr >= LOGIN_WAIT_TIMES.length) {\n            tryNr = LOGIN_WAIT_TIMES.length - 1;\n          }\n\n          this.log.info(`Wait ${LOGIN_WAIT_TIMES[tryNr] / 1000} seconds before next login try (#${tryNr+1}) ...`);\n          await this.wait(LOGIN_WAIT_TIMES[tryNr]);\n\n          return this.loginClient(tryNr);\n        }\n      } else {\n        this.log.error(`Unknown Discord login error`);\n      }\n      return false;\n    }\n  }\n\n  /**\n   * When the discord client is ready.\n   */\n  @boundMethod\n  private async onClientReady (): Promise<void> {\n    if (!this.client?.user) {\n      this.log.error('Discord client has no user!');\n      return;\n    }\n\n    this.log.info(`Logged in as ${this.client.user.tag}!`);\n    this.log.debug(`User ID: ${this.client.user.id}`);\n\n    // change the bot username/nickname if needed\n    if (this.config.botName) {\n      if (this.client.user.username !== this.config.botName) {\n        // update needed\n        this.log.debug(`Update of bot name needed - current name: ${this.client.user.username} - configured name: ${this.config.botName}`);\n        try {\n          const proms: Promise<any>[] = [];\n          proms.push(this.client.user.setUsername(this.config.botName));\n\n          for (const [, guild] of this.client.guilds.cache) {\n            const me = guild.members.cache.get(this.client.user.id);\n            if (me) {\n              proms.push(me.setNickname(this.config.botName));\n            }\n          }\n\n          await Promise.all(proms);\n          this.log.debug(`Bot name updated`);\n        } catch (err) {\n          this.log.warn(`Error setting the bot name to \"${this.config.botName}\": ${err}`);\n        }\n      } else {\n        // up to date\n        this.log.debug('Bot name is up to date');\n      }\n    }\n\n    try {\n      await this.updateGuilds();\n    } catch (err) {\n      this.log.error(`Error while updating server information: ${err}`);\n    }\n  }\n\n  /**\n   * Update the guilds (servers), channels and users seen by the discord bot.\n   * This will create/update all dynamic objects for all servers and users if needed.\n   */\n  private async updateGuilds (): Promise<void> {\n    if (!this.client?.user) {\n      throw new Error('Client not loaded');\n    }\n\n    /**\n     * Collection of known users on all known servers.\n     * Used to create/delete user objects.\n     */\n    const allServersUsers: Collection<Snowflake, { user: User, presence: Presence | null }> = new Collection();\n\n    /**\n     * Set of object IDs for all known servers and channels.\n     * Used to detect server/channel objects which have be deleted.\n     */\n    const knownServersAndChannelsIds: Set<string> = new Set();\n\n    if (this.unloaded) return;\n    const guilds = await this.client.guilds.fetch();\n    if (this.unloaded) return;\n\n    for (const [, guildBase] of guilds) {\n\n      if (this.unloaded) return;\n      let guild: Guild;\n      try {\n        guild = await guildBase.fetch();\n      } catch (err) {\n        this.log.warn(`Could not fetch guild information for guild \"${guildBase.name}\" id:${guildBase.id}`);\n        this.log.debug(`Error: ${err}`);\n        continue;\n      }\n      if (this.unloaded) return;\n\n      knownServersAndChannelsIds.add(`${this.namespace}.servers.${guild.id}`);\n\n      // create channel for this guild\n      await this.extendObjectAsyncCached(`servers.${guild.id}`, {\n        type: 'channel',\n        common: {\n          name: guild.name,\n        },\n        native: {},\n      });\n\n      await Promise.all([\n        this.extendObjectAsyncCached(`servers.${guild.id}.members`, {\n          type: 'channel',\n          common: {\n            name: i18n.getStringOrTranslated('Members'),\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`servers.${guild.id}.channels`, {\n          type: 'channel',\n          common: {\n            name: i18n.getStringOrTranslated('Channels'),\n          },\n          native: {},\n        }),\n      ]);\n\n      // add guild member objects\n      const guildMembers = await guild.members.fetch();\n      if (this.unloaded) return;\n\n      for (const [, member] of guildMembers) {\n        // remember user if not the bot itself\n        if (member.user.id !== this.client.user.id) {\n          allServersUsers.set(member.user.id, { user: member.user, presence: member.presence });\n        }\n\n        await this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}`, {\n          type: 'channel',\n          common: {\n            name: `${member.displayName} (${member.user.tag})`,\n          },\n          native: {},\n        });\n\n        await Promise.all([\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.tag`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('User tag'),\n              role: 'text',\n              type: 'string',\n              read: true,\n              write: false,\n              def: '',\n            },\n            native: {},\n          }),\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.displayName`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Display name'),\n              role: 'text',\n              type: 'string',\n              read: true,\n              write: false,\n              def: '',\n            },\n            native: {},\n          }),\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.roles`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Roles'),\n              role: 'text',\n              type: 'string',\n              read: true,\n              write: false,\n              def: '',\n            },\n            native: {},\n          }),\n\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.joinedAt`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Joined at'),\n              role: 'date',\n              type: 'number',\n              read: true,\n              write: false,\n              def: 0,\n            },\n            native: {},\n          }),\n\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.voiceChannel`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Voice channel'),\n              role: 'text',\n              type: 'string',\n              read: true,\n              write: false,\n              def: '',\n            },\n            native: {},\n          }),\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.voiceDisconnect`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Voice disconnect'),\n              role: 'button',\n              type: 'boolean',\n              read: false,\n              write: true,\n              def: false,\n            },\n            native: {},\n          }),\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.voiceSelfDeaf`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Voice self deafen'),\n              role: 'indicator',\n              type: 'boolean',\n              read: true,\n              write: false,\n              def: false,\n            },\n            native: {},\n          }),\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.voiceServerDeaf`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Voice server deafen'),\n              role: 'switch',\n              type: 'boolean',\n              read: true,\n              write: true,\n              def: false,\n            },\n            native: {},\n          }),\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.voiceSelfMute`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Voice self mute'),\n              role: 'indicator',\n              type: 'boolean',\n              read: true,\n              write: false,\n              def: false,\n            },\n            native: {},\n          }),\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.voiceServerMute`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('Voice server mute'),\n              role: 'switch',\n              type: 'boolean',\n              read: true,\n              write: true,\n              def: false,\n            },\n            native: {},\n          }),\n\n          this.extendObjectAsyncCached(`servers.${guild.id}.members.${member.id}.json`, {\n            type: 'state',\n            common: {\n              name: i18n.getStringOrTranslated('JSON data'),\n              role: 'json',\n              type: 'string',\n              read: true,\n              write: false,\n              def: '',\n            },\n            native: {},\n          }),\n        ]);\n\n\n        const memberRoles = member.roles.cache.map((role) => role.name);\n        await Promise.all([\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.tag`, member.user.tag, true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.displayName`, member.displayName, true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.roles`, memberRoles.join(', '), true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.joinedAt`, member.joinedTimestamp, true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.voiceChannel`, member.voice.channel?.name || '', true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.voiceSelfDeaf`, !!member.voice.selfDeaf, true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.voiceServerDeaf`, !!member.voice.serverDeaf, true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.voiceSelfMute`, !!member.voice.selfMute, true),\n          this.setStateAsync(`servers.${guild.id}.members.${member.id}.voiceServerMute`, !!member.voice.serverMute, true),\n        ]);\n\n        const json: JsonServersMembersObj = {\n          tag: member.user.tag,\n          id: member.id,\n          displayName: member.displayName,\n          roles: memberRoles,\n          joined: member.joinedTimestamp,\n          voiceChannel: member.voice.channel?.name || '',\n          voiceChannelId: member.voice.channel?.id || '',\n          voiceSelfDeaf: !!member.voice.selfDeaf,\n          voiceServerDeaf: !!member.voice.serverDeaf,\n          voiceSelfMute: !!member.voice.selfMute,\n          voiceServerMute: !!member.voice.serverMute,\n        };\n        if (!isDeepStrictEqual(json, this.jsonStateCache.get(`${this.namespace}.servers.${guild.id}.members.${member.id}.json`))) {\n          await this.setStateAsync(`servers.${guild.id}.members.${member.id}.json`, JSON.stringify(json), true);\n          this.jsonStateCache.set(`${this.namespace}.servers.${guild.id}.members.${member.id}.json`, json);\n        }\n\n      }\n\n      // guild channels\n      if (this.unloaded) return;\n      const channels = await guild.channels.fetch();\n      if (this.unloaded) return;\n\n      // loop over all channels twice to setup the parent channel objects first and afterwards the child channel objects\n      for (const parents of [true, false]) {\n        for (const [, channel] of channels) {\n          if ((parents && channel.parentId) || (!parents && !channel.parentId)) {\n            continue;\n          }\n          const channelIdPrefix = parents ? `servers.${guild.id}.channels.${channel.id}` : `servers.${guild.id}.channels.${channel.parentId}.channels.${channel.id}`;\n\n          knownServersAndChannelsIds.add(`${this.namespace}.${channelIdPrefix}`);\n\n          let icon: string | undefined = undefined;\n          if (channel.isText()) {\n            icon = 'channel-text.svg';\n          }\n          if (channel.isVoice()) {\n            icon = 'channel-voice.svg';\n          }\n          await this.extendObjectAsyncCached(channelIdPrefix, {\n            type: 'channel',\n            common: {\n              name: channel.parent ? `${channel.parent.name} / ${channel.name}` : channel.name,\n              icon,\n            },\n            native: {\n              channelId: channel.id,\n            },\n          });\n          if (channel.type === 'GUILD_CATEGORY') {\n            await this.extendObjectAsyncCached(`${channelIdPrefix}.channels`, {\n              type: 'channel',\n              common: {\n                name: i18n.getStringOrTranslated('Channels'),\n              },\n              native: {},\n            });\n          }\n\n          await Promise.all([\n            this.extendObjectAsyncCached(`${channelIdPrefix}.json`, {\n              type: 'state',\n              common: {\n                name: i18n.getStringOrTranslated('JSON data'),\n                role: 'json',\n                type: 'string',\n                read: true,\n                write: false,\n                def: '',\n              },\n              native: {},\n            }),\n            this.extendObjectAsyncCached(`${channelIdPrefix}.memberCount`, {\n              type: 'state',\n              common: {\n                name: i18n.getStringOrTranslated('Member count'),\n                role: 'value',\n                type: 'number',\n                read: true,\n                write: false,\n                def: 0,\n              },\n              native: {},\n            }),\n            this.extendObjectAsyncCached(`${channelIdPrefix}.members`, {\n              type: 'state',\n              common: {\n                name: i18n.getStringOrTranslated('Members'),\n                role: 'text',\n                type: 'string',\n                read: true,\n                write: false,\n                def: '',\n              },\n              native: {},\n            }),\n          ]);\n\n          if (channel.isText()) {\n            await Promise.all([\n              this.extendObjectAsyncCached(`${channelIdPrefix}.message`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Last message'),\n                  role: 'text',\n                  type: 'string',\n                  read: true,\n                  write: false,\n                  def: '',\n                },\n                native: {},\n              }),\n              this.extendObjectAsyncCached(`${channelIdPrefix}.messageId`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Last message ID'),\n                  role: 'text',\n                  type: 'string',\n                  read: true,\n                  write: false,\n                  def: '',\n                },\n                native: {},\n              }),\n              this.extendObjectAsyncCached(`${channelIdPrefix}.messageAuthor`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Last message author'),\n                  role: 'text',\n                  type: 'string',\n                  read: true,\n                  write: false,\n                  def: '',\n                },\n                native: {},\n              }),\n              this.extendObjectAsyncCached(`${channelIdPrefix}.messageTimestamp`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Last message timestamp'),\n                  role: 'date',\n                  type: 'number',\n                  read: true,\n                  write: false,\n                  def: 0,\n                },\n                native: {},\n              }),\n              this.extendObjectAsyncCached(`${channelIdPrefix}.messageJson`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Last message JSON data'),\n                  role: 'json',\n                  type: 'string',\n                  read: true,\n                  write: false,\n                  def: '',\n                },\n                native: {},\n              }),\n\n              this.extendObjectAsyncCached(`${channelIdPrefix}.send`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Send message'),\n                  role: 'text',\n                  type: 'string',\n                  read: false,\n                  write: true,\n                  def: '',\n                },\n                native: {},\n              }),\n              this.extendObjectAsyncCached(`${channelIdPrefix}.sendFile`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Send file'),\n                  role: 'text',\n                  type: 'string',\n                  read: false,\n                  write: true,\n                  def: '',\n                },\n                native: {},\n              }),\n              this.extendObjectAsyncCached(`${channelIdPrefix}.sendReply`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Send reply'),\n                  role: 'text',\n                  type: 'string',\n                  read: false,\n                  write: true,\n                  def: '',\n                },\n                native: {},\n              }),\n              this.extendObjectAsyncCached(`${channelIdPrefix}.sendReaction`, {\n                type: 'state',\n                common: {\n                  name: i18n.getStringOrTranslated('Send reaction'),\n                  role: 'text',\n                  type: 'string',\n                  read: false,\n                  write: true,\n                  def: '',\n                },\n                native: {},\n              }),\n            ]);\n\n            this.messageReceiveStates.add(`${this.namespace}.${channelIdPrefix}.message`);\n          }\n\n          const members = [...channel.members.values()];\n          const json: JsonServersChannelsObj = {\n            id: channel.id,\n            name: channel.name,\n            type: channel.type,\n            memberCount: members.length,\n            members: members.map((m) => ({\n              id: m.user.id,\n              tag: m.user.tag,\n              displayName: m.displayName,\n            })),\n          };\n          const proms: Promise<any>[] = [];\n          if (!isDeepStrictEqual(json, this.jsonStateCache.get(`${this.namespace}.${channelIdPrefix}.json`))) {\n            proms.push(this.setStateAsync(`${channelIdPrefix}.json`, JSON.stringify(json), true));\n            this.jsonStateCache.set(`${this.namespace}.${channelIdPrefix}.json`, json);\n          }\n          await Promise.all([\n            this.setStateAsync(`${channelIdPrefix}.memberCount`, members.length, true),\n            this.setStateAsync(`${channelIdPrefix}.members`, members.map((m) => m.displayName).join(', '), true),\n            ...proms,\n          ]);\n        }\n      }\n    }\n\n    /*\n     * Create objects/states for all known users.\n     */\n    for (const [, {user, presence}] of allServersUsers) {\n      this.log.debug(`Known user: ${user.tag} id:${user.id}`);\n\n      await this.extendObjectAsyncCached(`users.${user.id}`, {\n        type: 'channel',\n        common: {\n          name: user.tag,\n        },\n        native: {\n          userId: user.id,\n        },\n      });\n\n      await Promise.all([\n        this.extendObjectAsyncCached(`users.${user.id}.json`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('JSON data'),\n            role: 'json',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n\n        this.extendObjectAsyncCached(`users.${user.id}.tag`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('User tag'),\n            role: 'text',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n\n        this.extendObjectAsyncCached(`users.${user.id}.message`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Last message'),\n            role: 'text',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.messageId`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Last message ID'),\n            role: 'text',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.messageTimestamp`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Last message timestamp'),\n            role: 'date',\n            type: 'number',\n            read: true,\n            write: false,\n            def: 0,\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.messageJson`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Last message JSON data'),\n            role: 'json',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n\n        this.extendObjectAsyncCached(`users.${user.id}.send`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Send message'),\n            role: 'text',\n            type: 'string',\n            read: false,\n            write: true,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.sendFile`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Send file'),\n            role: 'text',\n            type: 'string',\n            read: false,\n            write: true,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.sendReply`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Send reply'),\n            role: 'text',\n            type: 'string',\n            read: false,\n            write: true,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.sendReaction`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Send reaction'),\n            role: 'text',\n            type: 'string',\n            read: false,\n            write: true,\n            def: '',\n          },\n          native: {},\n        }),\n\n        this.extendObjectAsyncCached(`users.${user.id}.avatarUrl`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Avatar'),\n            role: 'media.link',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n\n        this.extendObjectAsyncCached(`users.${user.id}.bot`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Bot'),\n            role: 'indicator',\n            type: 'boolean',\n            read: true,\n            write: false,\n            def: false,\n          },\n          native: {},\n        }),\n\n        this.extendObjectAsyncCached(`users.${user.id}.status`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Status'),\n            role: 'text',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.activityType`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Activity type'),\n            role: 'text',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n        this.extendObjectAsyncCached(`users.${user.id}.activityName`, {\n          type: 'state',\n          common: {\n            name: i18n.getStringOrTranslated('Activity name'),\n            role: 'text',\n            type: 'string',\n            read: true,\n            write: false,\n            def: '',\n          },\n          native: {},\n        }),\n      ]);\n\n      this.messageReceiveStates.add(`${this.namespace}.users.${user.id}.message`);\n\n      this.knownUsers.add(user.id);\n\n      const ps = await this.updateUserPresence(user.id, presence, true);\n\n      const proms: Promise<any>[] = [];\n      const json: JsonUsersObj = {\n        id: user.id,\n        tag: user.tag,\n        activityName: ps.activityName,\n        activityType: ps.activityType,\n        avatarUrl: user.displayAvatarURL(),\n        bot: user.bot,\n        status: ps.status,\n      };\n      if (!isDeepStrictEqual(json, this.jsonStateCache.get(`${this.namespace}.users.${user.id}.json`))) {\n        proms.push(this.setStateAsync(`users.${user.id}.json`, JSON.stringify(json), true));\n        this.jsonStateCache.set(`${this.namespace}.users.${user.id}.json`, json);\n      }\n      await Promise.all([\n        this.setStateAsync(`users.${user.id}.tag`, user.tag, true),\n        this.setStateAsync(`users.${user.id}.avatarUrl`, json.avatarUrl, true),\n        this.setStateAsync(`users.${user.id}.bot`, user.bot, true),\n        ...proms,\n        this.updateUserPresence(user.id, presence),\n      ]);\n\n    }\n\n    /*\n     * Delete objects for unknown Channels/Servers\n     */\n    const objListServers = await this.getObjectListAsync({\n      startkey: `${this.namespace}.servers.`,\n      endkey: `${this.namespace}.servers.\\u9999`,\n    });\n    const reServersChannels = new RegExp(`^${this.name}\\\\.${this.instance}\\\\.servers\\\\.((\\\\d+)(\\\\.channels\\\\.(\\\\d+)){0,2})$`);\n    for (const item of objListServers.rows) {\n      const m = item.id.match(reServersChannels);\n      if (m) {\n        const idPath = m[1];\n        if (!knownServersAndChannelsIds.has(item.id)) {\n          this.log.debug(`Server/Channel ${idPath} \"${item.value.common.name}\" is no longer available - deleting objects`);\n          this.messageReceiveStates.delete(`${this.namespace}.servers.${idPath}.message`);\n          this.jsonStateCache.delete(`${this.namespace}.servers.${idPath}.json`);\n          await this.delObjectAsyncCached(`servers.${idPath}`, { recursive: true });\n        }\n      }\n    }\n\n    /*\n     * Delete objects for unknown users\n     */\n    const objListUsers = await this.getObjectListAsync({\n      startkey: `${this.namespace}.users.`,\n      endkey: `${this.namespace}.users.\\u9999`,\n    });\n    const reUsers = new RegExp(`^${this.name}\\\\.${this.instance}\\\\.users\\\\.(\\\\d+)$`);\n    for (const item of objListUsers.rows) {\n      const m = item.id.match(reUsers);\n      if (m) {\n        const userId = m[1];\n        if (!allServersUsers.has(userId)) {\n          this.log.debug(`User ${userId} \"${item.value.common.name}\" is no longer available - deleting objects`);\n          this.knownUsers.delete(userId);\n          this.messageReceiveStates.delete(`${this.namespace}.users.${userId}.message`);\n          this.jsonStateCache.delete(`${this.namespace}.users.${userId}.json`);\n          await this.delObjectAsyncCached(`users.${userId}`, { recursive: true });\n        }\n      }\n    }\n  }\n\n  /**\n   * Update the presence states of a user.\n   * @param userId ID of the user.\n   * @param presence The user presence.\n   * @param skipJsonStateUpdate If the json state of the user should not be updated.\n   */\n  private async updateUserPresence (userId: Snowflake, presence: Presence | null, skipJsonStateUpdate: boolean = false): Promise<UpdateUserPresenceResult> {\n    if (!this.config.observeUserPresence) {\n      return { activityName: '', activityType: '', status: '' };\n    }\n\n    if (!this.knownUsers.has(userId)) {\n      this.log.debug(`Can't update user presence for unknown user ${userId}`);\n      return { activityName: '', activityType: '', status: '' };\n    }\n\n    try {\n      const p: UpdateUserPresenceResult = {\n        status: presence?.status || '',\n        activityName: (presence?.activities[0]?.type === 'CUSTOM' ? presence?.activities[0]?.state : presence?.activities[0]?.name) || '',\n        activityType: presence?.activities[0]?.type || '',\n      };\n      const proms: Promise<any>[] = [];\n      if (!skipJsonStateUpdate) {\n        const json = this.jsonStateCache.get(`${this.namespace}.users.${userId}.json`) as JsonUsersObj | undefined;\n        if (json) {\n          json.status = p.status;\n          json.activityName = p.activityName;\n          json.activityType = p.activityType;\n          this.jsonStateCache.set(`${this.namespace}.users.${userId}.json`, json);\n          proms.push(this.setStateAsync(`users.${userId}.json`, JSON.stringify(json), true));\n        }\n      }\n      await Promise.all([\n        this.setStateAsync(`users.${userId}.status`, p.status , true),\n        this.setStateAsync(`users.${userId}.activityName`, p.activityName, true),\n        this.setStateAsync(`users.${userId}.activityType`, p.activityType, true),\n        ...proms,\n      ]);\n      return p;\n    } catch (err) {\n      this.log.warn(`Error while updating user presence of user ${userId}: ${err}`);\n      return { activityName: '', activityType: '', status: '' };\n    }\n  }\n\n  /**\n   * Set the presence status of the discord bot.\n   */\n  private async setBotPresence (opts?: SetBotPresenceOptions): Promise<void> {\n    if (!this.client?.user) return;\n\n    if (!opts) {\n      opts = {};\n    }\n\n    if (!opts.status) {\n      opts.status = ((await this.getStateAsync('bot.status'))?.val as PresenceStatusData | undefined) || 'online';\n    }\n    if (!VALID_PRESENCE_STATUS_DATA.includes(opts.status)) {\n      opts.status = 'online';\n    }\n\n    const presenceData: PresenceData = {\n      status: opts.status,\n      activities: [],\n    };\n\n    if (opts.activityType === undefined) {\n      opts.activityType = ((await this.getStateAsync('bot.activityType'))?.val as ValidActivityType | undefined) || '';\n    }\n    if (!VALID_ACTIVITY_TYPES.includes(opts.activityType)) {\n      opts.activityType = '';\n    }\n    if (opts.activityName === undefined) {\n      opts.activityName = ((await this.getStateAsync('bot.activityName'))?.val as string | undefined) || '';\n    }\n    if (opts.activityType && opts.activityName) {\n      presenceData.activities = [{\n        type: opts.activityType,\n        name: opts.activityName,\n      }];\n    }\n\n    this.log.debug(`Set bot presence: ${JSON.stringify(presenceData)}`);\n    this.client.user.setPresence(presenceData);\n  }\n\n  /**\n   * Handler for received discord messages.\n   * @param message The discord message.\n   */\n  @boundMethod\n  private async onClientMessageCreate (message: Message<boolean>): Promise<void> {\n    this.log.debug(`Discord message: mId:${message.id} cId:${message.channelId} uId: ${message.author.id} - ${message.content}`);\n\n    // raw states enabled?\n    if (this.config.enableRawStates) {\n      // set raw state... not async here since it should not block!\n      this.setState('raw.messageJson', JSON.stringify(message.toJSON(), (_key, value) => typeof value === 'bigint' ? value.toString() : value), true);\n    }\n\n    if (!this.client?.user?.id) return;\n\n    // don't process interactions here\n    if (message.interaction) {\n      return;\n    }\n\n    const { author, channel, content } = message;\n\n    // don't process own messages\n    if (author.id === this.client.user.id) {\n      return;\n    }\n\n    const authCheckTarget = message.member || author;\n\n    const isAuthorAuthorized = this.checkUserAuthorization(authCheckTarget);\n\n    if (!this.config.processMessagesFromUnauthorizedUsers && !isAuthorAuthorized) {\n      this.log.debug(`Ignore message from unauthorized user ${author.tag} (id:${author.id})`);\n      return;\n    }\n\n    const mentioned = message.mentions.users.has(this.client.user.id);\n\n    if (mentioned && this.config.reactOnMentions && isAuthorAuthorized) {\n      try {\n        await message.react(this.config.reactOnMentionsEmoji);\n      } catch (err) {\n        this.log.warn(`Error while adding reaction to message ${message.id}! ${err}`);\n      }\n    }\n\n    if (!mentioned && channel.type === 'GUILD_TEXT' && !this.config.processAllMessagesInServerChannel) {\n      this.log.debug('Server channel message without mention ignored');\n      return;\n    }\n\n    let msgStateIdPrefix: string;\n    if (channel.type === 'GUILD_TEXT') {\n      msgStateIdPrefix = channel.parentId ? `${this.namespace}.servers.${message.guildId}.channels.${channel.parentId}.channels.${channel.id}` : `${this.namespace}.servers.${message.guildId}.channels.${channel.id}`;\n    } else if (channel.type === 'DM') {\n      msgStateIdPrefix = `${this.namespace}.users.${author.id}`;\n    } else {\n      this.log.warn('Received unexpected message!');\n      return;\n    }\n\n    // check if a valid object/state for this received message is known by the adapter\n    if (!this.messageReceiveStates.has(`${msgStateIdPrefix}.message`)) {\n      this.log.debug(`State for received message ${msgStateIdPrefix} is not known for receiving messages`);\n      return;\n    }\n\n    // prepare json state object\n    const json: JsonMessageObj = {\n      content,\n      attachments: message.attachments.map((att) => ({ attachment: att.attachment.toString(), name: att.name, size: att.size, id: att.id })),\n      id: message.id,\n      mentions: message.mentions.members?.map((m) => ({ id: m.id, tag: m.user.tag, displayName: m.displayName })) || [],\n      mentioned,\n      timestamp: message.createdTimestamp,\n      authorized: isAuthorAuthorized,\n    };\n    const proms: Promise<any>[] = [];\n    if (message.guildId) {\n      json.author = {\n        id: author.id,\n        tag: author.tag,\n        displayName: this.client.guilds.cache.get(message.guildId)?.members.cache.get(author.id)?.displayName || author.username,\n      };\n      proms.push(this.setStateAsync(`${msgStateIdPrefix}.messageAuthor`, author.tag, true));\n    }\n    if (!isDeepStrictEqual(json, this.jsonStateCache.get(`${this.namespace}.${msgStateIdPrefix}.messageJson`))) {\n      proms.push(this.setStateAsync(`${msgStateIdPrefix}.messageJson`, JSON.stringify(json), true));\n      this.jsonStateCache.set(`${this.namespace}.${msgStateIdPrefix}.messageJson`, json);\n    }\n    await Promise.all([\n      this.setStateAsync(`${msgStateIdPrefix}.message`, content, true),\n      this.setStateAsync(`${msgStateIdPrefix}.messageId`, message.id, true),\n      this.setStateAsync(`${msgStateIdPrefix}.messageTimestamp`, message.createdTimestamp, true),\n      ...proms,\n    ]);\n\n    // handle text2command if enabled for this receiving state\n    if (content && this.config.text2commandInstance && this.text2commandObjects.has(`${msgStateIdPrefix}.message`)) {\n      // check user authorization to use text2command\n      if (this.checkUserAuthorization(authCheckTarget, { useText2command: true })) {\n        // authorization disabled or user is allowed to use text2command\n        this.log.debug(`Sending \"${content}\" to ${this.config.text2commandInstance}`);\n        // prepare message payload\n        const payload: Text2commandMessagePayload = {\n          text: content,\n        };\n        // use callback style sendTo here to not block message processing here if text2command instance is not running\n        this.sendTo(this.config.text2commandInstance, 'send', payload, async (responseObj) => {\n          // Response object from text2command is the message payload from the sendTo call with a `response` property set\n          const response: string | undefined = (responseObj as unknown as Text2commandMessagePayload | undefined)?.response;\n          try {\n            if (!response) {\n              this.log.debug(`Empty response from ${this.config.text2commandInstance}`);\n              return;\n            }\n            this.log.debug(`Response from ${this.config.text2commandInstance}: ${response}`);\n            switch (this.config.text2commandRespondWith) {\n              case 'reply':\n                await message.reply(response);\n                break;\n              case 'message':\n                await message.channel.send(response);\n                break;\n              default:\n                // no response needed\n            }\n          } catch (err) {\n            this.log.warn(`Error while processing response \"${response}\" from ${this.config.text2commandInstance}! ${err}`);\n          }\n        });\n      } else {\n        // user NOT allowed to text2command\n        this.log.debug(`User ${author.tag} (id:${author.id}) NOT allowed to use text2command`);\n      }\n    }\n\n  }\n\n  /**\n   * Handler for user voice state changes.\n   */\n  @boundMethod\n  private async onClientVoiceStateUpdate (oldState: VoiceState, newState: VoiceState): Promise<void> {\n    if (!newState.member?.id) {\n      return;\n    }\n\n    if (!this.knownUsers.has(newState.member.id)) {\n      this.log.debug(`Can't update user voice state for unknown user ${newState.member.id}`);\n      return;\n    }\n\n    const proms: Promise<any>[] = [];\n    const json: JsonServersMembersObj = {\n      ...this.jsonStateCache.get(`${this.namespace}.servers.${newState.guild.id}.members.${newState.member.id}.json`) as JsonServersMembersObj,\n    };\n\n    let update: boolean = false;\n\n    if (oldState.channelId !== newState.channelId) {\n      proms.push(this.setStateAsync(`servers.${newState.guild.id}.members.${newState.member.id}.voiceChannel`, newState.channel?.name || '', true));\n      json.voiceChannel = newState.channel?.name || '';\n      update = true;\n    }\n    if (oldState.serverDeaf !== newState.serverDeaf) {\n      proms.push(this.setStateAsync(`servers.${newState.guild.id}.members.${newState.member.id}.voiceServerDeaf`, !!newState.serverDeaf, true));\n      json.voiceSelfDeaf = !!newState.selfDeaf;\n      update = true;\n    }\n    if (oldState.selfDeaf !== newState.selfDeaf) {\n      proms.push(this.setStateAsync(`servers.${newState.guild.id}.members.${newState.member.id}.voiceSelfDeaf`, !!newState.selfDeaf, true));\n      json.voiceServerDeaf = !!newState.serverDeaf;\n      update = true;\n    }\n    if (oldState.serverMute !== newState.serverMute) {\n      proms.push(this.setStateAsync(`servers.${newState.guild.id}.members.${newState.member.id}.voiceServerMute`, !!newState.serverMute, true));\n      json.voiceSelfMute = !!newState.selfMute;\n      update = true;\n    }\n    if (oldState.selfMute !== newState.selfMute) {\n      proms.push(this.setStateAsync(`servers.${newState.guild.id}.members.${newState.member.id}.voiceSelfMute`, !!newState.selfMute, true));\n      json.voiceServerMute = !!newState.serverMute;\n      update = true;\n    }\n\n    // json state update\n    if (update) {\n      proms.push(this.setStateAsync(`servers.${newState.guild.id}.members.${newState.member.id}.json`, JSON.stringify(json), true));\n      this.jsonStateCache.set(`${this.namespace}.servers.${newState.guild.id}.members.${newState.member.id}.json`, json);\n    }\n\n    await Promise.all(proms);\n  }\n\n  /**\n   * Setup for objects custom config related to the adapter instance.\n   * E.g. text2command enabled or state availability for commands.\n   * @param objId The object ID.\n   * @param customCfg The custom config part of the object for this adapter instance.\n   */\n  private async setupObjCustom (objId: string, customCfg: ioBroker.CustomConfig | null | undefined, objCommon?: ioBroker.StateCommon): Promise<void> {\n    // own .message objects - enableText2command\n    if (objId.startsWith(`${this.namespace}.`) && objId.endsWith('.message')) {\n      if (customCfg?.enabled && customCfg.enableText2command) {\n        this.log.debug(`Custom option text2command enabled for ${objId}`);\n        this.text2commandObjects.add(objId);\n      } else if (this.text2commandObjects.has(objId)) {\n        this.log.debug(`Custom option text2command disabled for ${objId}`);\n        this.text2commandObjects.delete(objId);\n      }\n    }\n\n    if (customCfg?.enableCommands) {\n      // commands enabled\n\n      // load objCommon if not provided\n      if (!objCommon) {\n        const obj = await this.getForeignObjectAsync(objId);\n        if (obj?.type === 'state') {\n          objCommon = obj.common;\n        } else {\n          this.log.warn(`Object ${objId} has commands enabled but this seams to be an error because it is not a state object!`);\n        }\n      }\n\n      // try to get the name\n      let name = customCfg.commandsName;\n      if (!name && objCommon) {\n        if (typeof objCommon.name === 'object') {\n          name = objCommon.name[i18n.language] || objCommon.name.en;\n        } else {\n          name = objCommon.name;\n        }\n      }\n\n      const cfg: CommandObjectConfig = {\n        id: objId,\n        alias: customCfg.commandsAlias || objId,\n        name: name || objId,\n        get: !!customCfg.commandsAllowGet,\n        set: !!customCfg.commandsAllowSet,\n      };\n\n      // do some checks\n      let cfgOk: boolean = true;\n      if (cfg.name.length > 100) {\n        this.log.warn(`Command name for ${objId} exceeds the limit of 100 chars! This object will be ignored.`);\n        cfgOk = false;\n      }\n      if (!cfg.alias.match(/^[0-9a-zA-Z._-]{0,100}$/)) {\n        this.log.warn(`Command alias for ${objId} includes invalid chars or exceeds the limit of 100 chars! This object will be ignored.`);\n        cfgOk = false;\n      }\n\n      // setup command\n      this.discordSlashCommands.setupCommandObject(objId, cfgOk ? cfg : null);\n\n    } else {\n      // commands not enabled\n      this.discordSlashCommands.setupCommandObject(objId, null);\n    }\n  }\n\n  /**\n   * Is called if a subscribed object changes.\n   */\n  @boundMethod\n  private onObjectChange (objId: string, obj: ioBroker.Object | null | undefined): void {\n    if (obj) {\n      // The object was changed\n      if (obj.type === 'state') {\n        this.log.silly(`Object ${objId} changed: ${JSON.stringify(obj)}`);\n        this.setupObjCustom(objId, obj.common?.custom?.[this.namespace], obj.common);\n      }\n    } else {\n      // The object was deleted\n      this.log.silly(`Object ${objId} deleted`);\n      this.setupObjCustom(objId, null);\n    }\n  }\n\n  /**\n   * Is called if a subscribed state changes\n   */\n  @boundMethod\n  private async onStateChange(stateId: string, state: ioBroker.State | null | undefined): Promise<void> {\n    this.log.silly(`State changed: ${stateId} ${state?.val} (ack=${state?.ack})`);\n\n    if (!state || state.ack) return;\n\n    let setAck = false;\n\n    /*\n     * Own states\n     */\n    if (stateId.startsWith(`${this.namespace}.`)) {\n\n      switch (stateId) {\n        case `${this.namespace}.bot.status`:\n          await this.setBotPresence({ status: state.val as PresenceStatusData });\n          setAck = true;\n          break;\n        case `${this.namespace}.bot.activityType`:\n          await this.setBotPresence({ activityType: state.val as ValidActivityType });\n          setAck = true;\n          break;\n        case `${this.namespace}.bot.activityName`:\n          await this.setBotPresence({ activityName: state.val as string });\n          setAck = true;\n          break;\n\n        default: // other own states\n          // custom slash command reply\n          if (stateId.match(/^discord\\.\\d+\\.slashCommands\\..*\\.sendReply/)) {\n            setAck = await this.onCustomCommandSendReplyStateChange(stateId, state);\n\n          // .send / .sendFile / .sendReply\n          } else if (stateId.endsWith('.send') || stateId.endsWith('.sendFile') || stateId.endsWith('.sendReply') || stateId.endsWith('.sendReaction')) {\n            setAck = await this.onSendStateChange(stateId, state);\n\n          // voice disconnect, mute/unmute, deafen/undeafen\n          } else if (stateId.endsWith('.voiceDisconnect') || stateId.endsWith('.voiceServerMute') || stateId.endsWith('.voiceServerDeaf')) {\n            setAck = await this.onVoiceStateChange(stateId, state);\n\n          }\n      }\n\n    }\n\n    if (setAck) {\n      await this.setStateAsync(stateId, {\n        ...state,\n        ack: true,\n      });\n    }\n\n  }\n\n  /**\n   * Handler for changes on own .send or .sendFile states.\n   * Sends the given text, json or file to the corresponding discord channel.\n   * @returns `true` if the message is send.\n   */\n  private async onSendStateChange (stateId: string, state: ioBroker.State): Promise<boolean> {\n\n    if (!this.client?.isReady()) {\n      this.log.warn(`State ${stateId} changed but client is not ready!`);\n      return false;\n    }\n\n    if (typeof state.val !== 'string') {\n      this.log.warn(`State ${stateId} changed but value if not a string!`);\n      return false;\n    }\n\n    if (state.val.length === 0) {\n      this.log.debug(`State ${stateId} changed but value is empty`);\n      return false;\n    }\n\n    let action: string;\n    let target: NonThreadGuildBasedChannel | User;\n    let targetName: string = '';\n    let targetStateIdBase: string;\n\n    // channel or user?\n    let m = stateId.match(/^(discord\\.\\d+\\.servers\\.(\\d+)\\.channels\\.(\\d+)(\\.channels\\.(\\d+))?)\\.(send|sendFile|sendReaction|sendReply)$/);\n    if (m) {\n      const guildId = m[2];\n      const channelId = m[5] || m[3];\n      targetStateIdBase = m[1];\n      action = m[6];\n\n      const channel = this.client.guilds.cache.get(guildId)?.channels.cache.get(channelId);\n      if (!channel?.isText() || channel.isThread()) {\n        this.log.warn(`State ${stateId} changed but target is not a valid text channel!`);\n        return false;\n      }\n\n      target = channel;\n      targetName = channel.parent ? `${channel.guild.name}/${channel.parent.name}/${channel.name}` : `${channel.guild.name}/${channel.name}`;\n\n    } else {\n      m = stateId.match(/^(discord\\.\\d+\\.users\\.(\\d+))\\.(send|sendFile|sendReaction|sendReply)$/);\n      if (!m) {\n        this.log.warn(`State ${stateId} changed but could not determine target to send message to!`);\n        return false;\n      }\n      const userId = m[2];\n      targetStateIdBase = m[1];\n      action = m[3];\n\n      const user = this.client.users.cache.get(userId);\n      if (!user) {\n        this.log.warn(`State ${stateId} changed but target is not a valid user!`);\n        return false;\n      }\n\n      target = user;\n      targetName = user.tag;\n    }\n\n    let mo: MessageOptions;\n\n    /*\n     * Special case .sendFile state\n     */\n    if (action === 'sendFile') {\n      const idx = state.val.indexOf('|');\n      let file: string;\n      let content: string | undefined = undefined;\n      if (idx > 0) {\n        file = state.val.slice(0, idx);\n        content = state.val.slice(idx + 1);\n      } else {\n        file = state.val;\n      }\n\n      // check for base64 encoded data\n      const b64data = getBufferAndNameFromBase64String(file);\n      if (b64data) {\n        // base64 encoded content\n        mo = {\n          content,\n          files: [{\n            attachment: b64data.buffer,\n            name: b64data.name,\n          }],\n        };\n\n      } else {\n        // not base64 encoded content\n        const name = getBasenameFromFilePathOrUrl(file);\n\n        // remove file:// prefix\n        if (file.startsWith('file://')) {\n          file = file.slice(7);\n        }\n\n        mo = {\n          content,\n          files: [{\n            attachment: file,\n            name,\n          }],\n        };\n      }\n\n\n    /*\n      * Special case .sendReply state\n      */\n    } else if (action === 'sendReply' || action === 'sendReaction') {\n      const idx = state.val.indexOf('|');\n      let messageReference: string;\n      let content: string;\n      if (idx > 0) {\n        messageReference = state.val.slice(0, idx);\n        content = state.val.slice(idx + 1);\n      } else {\n        // use id from last received message\n        this.log.debug(`Get reply message reference from last received message for ${targetStateIdBase}`);\n        messageReference = (await this.getForeignStateAsync(`${targetStateIdBase}.messageId`))?.val as string;\n        content = state.val;\n      }\n\n      if (action === 'sendReply') {\n        // reply\n        if (!messageReference || !content) {\n          this.log.warn(`No message reference or no content for reply for ${stateId}!`);\n          return false;\n        }\n\n        try {\n          mo = this.parseStringifiedMessageOptions(state.val);\n        } catch (err) {\n          this.log.debug(`State ${stateId} value is invalid: ${err}`);\n          return false;\n        }\n\n        // add the message reference if it is not already set\n        if (!mo.reply) {\n          mo.reply = {\n            messageReference,\n          };\n        } else if (!mo.reply.messageReference) {\n          mo.reply.messageReference = messageReference;\n        }\n\n      } else {\n        // reaction\n        if (!messageReference || !content) {\n          this.log.warn(`No message reference or no/invalid content for reaction for ${stateId}!`);\n          return false;\n        }\n\n        const channel = target instanceof User ? target.dmChannel || await target.createDM() : target;\n        if (!channel || !channel.isText()) {\n          this.log.warn(`Could not determine target channel for reaction ${stateId}!`);\n          return false;\n        }\n\n        // get the message from cache or try to fetch the message\n        const message: Message<boolean> | undefined = channel.messages.cache.get(messageReference) || await channel.messages.fetch(messageReference);\n        if (!message) {\n          this.log.warn(`Could not determine target message for reaction ${stateId}!`);\n          return false;\n        }\n\n        try {\n          await message.react(content);\n          return true;\n        } catch (err) {\n          this.log.warn(`Message reaction ${stateId} failed: ${err}`);\n          return false;\n        }\n      }\n\n\n    /*\n     * `state.val` may be JSON for .send states\n     * Try to parse the JSON as MessageOptions object to allow sending of files, embeds, ...\n     */\n    } else {\n      try {\n        mo = this.parseStringifiedMessageOptions(state.val);\n      } catch (err) {\n        this.log.debug(`State ${stateId} value is invalid: ${err}`);\n        return false;\n      }\n    }\n\n    this.log.debug(`Send to ${targetName}: ${JSON.stringify(mo)}`);\n    try {\n      const msg = await target.send(mo);\n      this.log.debug(`Sent with message ID ${msg.id}`);\n      return true;\n    } catch (err) {\n      this.log.warn(`Error sending value of ${stateId} to ${targetName}: ${err}`);\n      return false;\n    }\n  }\n\n  /**\n   * Handler for changes on own custom commands .sendReply states.\n   * Sends the given text, json or file to the corresponding discord channel.\n   * @returns `true` if the reply is send.\n   */\n  private async onCustomCommandSendReplyStateChange (stateId: string, state: ioBroker.State): Promise<boolean> {\n\n    if (!this.client?.isReady()) {\n      this.log.warn(`State ${stateId} changed but client is not ready!`);\n      return false;\n    }\n\n    if (typeof state.val !== 'string') {\n      this.log.warn(`State ${stateId} changed but value if not a string!`);\n      return false;\n    }\n\n    if (state.val.length === 0) {\n      this.log.debug(`State ${stateId} changed but value is empty`);\n      return false;\n    }\n\n    const targetStateIdBase = stateId.replace(/\\.\\w+$/, '');\n\n    const idx = state.val.indexOf('|');\n    let interactionId: Snowflake;\n    let content: string;\n    if (idx > 0) {\n      interactionId = state.val.slice(0, idx);\n      content = state.val.slice(idx + 1);\n    } else {\n      // use id from last received command\n      this.log.debug(`Get reply interaction reference from last received interaction for ${targetStateIdBase}`);\n      interactionId = (await this.getForeignStateAsync(`${targetStateIdBase}.interactionId`))?.val as string;\n      content = state.val;\n    }\n\n    if (!interactionId || !content) {\n      this.log.warn(`No interaction reference or no content for reply for ${stateId}!`);\n      return false;\n    }\n\n    try {\n      await this.discordSlashCommands.sendCmdCustomReply(interactionId, content);\n      return true;\n    } catch (err) {\n      this.log.warn(`Error while replying to interaction ${interactionId} of custom slash command! ${err}`);\n      return false;\n    }\n  }\n\n  /**\n   * Handler for changes of own .voiceDisconnect, .voiceServerMute or .voiceServerDeaf states.\n   * @returns `true` if successfull.\n   */\n  private async onVoiceStateChange (stateId: string, state: ioBroker.State): Promise<boolean> {\n    const m = stateId.match(/^discord\\.\\d+\\.servers\\.(\\d+)\\.members\\.(\\d+)\\.voice(Disconnect|ServerMute|ServerDeaf)$/);\n    if (!m) {\n      this.log.debug(`Voice state ${stateId} changed but could not get serverID and memberID!`);\n      return false;\n    }\n    const [, guildId, memberId, action] = m;\n\n    const guild = this.client?.guilds.cache.get(guildId);\n    const member = guild?.members.cache.get(memberId);\n    if (!guild || !member) {\n      this.log.warn(`Voice state ${stateId} changed but could not get the server member!`);\n      return false;\n    }\n\n    try {\n      switch (action) {\n        case 'Disconnect':\n          if (!state.val) {\n            return false;\n          }\n          await member.voice.disconnect();\n          this.log.debug(`Voice member ${member.user.tag} of server ${guild.name} disconnected.`);\n          break;\n\n        case 'ServerDeaf':\n          await member.voice.setDeaf(!!state.val);\n          this.log.debug(`Voice server deafen of member ${member.user.tag} of server ${guild.name} set to ${!!state.val}.`);\n          break;\n\n        case 'ServerMute':\n          await member.voice.setMute(!!state.val);\n          this.log.debug(`Voice server mute of member ${member.user.tag} of server ${guild.name} set to ${!!state.val}.`);\n          break;\n\n        default:\n          // should never happen...\n          return false;\n      }\n      return true;\n    } catch (err) {\n      this.log.warn(`Voice server action of member ${member.user.tag} of server ${guild.name} can't be done! ${err}`);\n      return false;\n    }\n  }\n\n  /**\n   * Handle messages send to the adapter.\n   */\n  @boundMethod\n  private async onMessage (obj: ioBroker.Message): Promise<void> {\n    if (typeof obj !== 'object') return;\n    this.log.debug(`Got message: ${JSON.stringify(obj)}`);\n\n    // channel and msg are needed in some switch cases...\n    let channel: GuildBasedChannel | undefined;\n    let msg: Message<boolean>;\n    let user: User | undefined;\n\n    switch (obj.command) {\n      case 'getText2commandInstances':\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n        const view = await this.getObjectViewAsync('system', 'instance', {\n          startkey: 'system.adapter.text2command.',\n          endkey: 'system.adapter.text2command.\\u9999',\n        });\n        const text2commandInstances = view.rows.map((r) => {\n          const id = r.id.slice(15);\n          return {\n            label: id,\n            value: id,\n          };\n        });\n        this.log.debug(`Found text2command instances: ${text2commandInstances.map((i) => i.value)}`);\n        this.sendTo(obj.from, obj.command, [{value: '', label: '---'}, ...text2commandInstances], obj.callback);\n        break;\n\n      case 'getUsers':\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        const users = this.client?.users.cache.map((u) => ({ label: u.tag, value: u.id })) || [];\n        this.log.debug(`Users: ${users.map((i) => i.value)}`);\n        this.sendTo(obj.from, obj.command, users, obj.callback);\n        break;\n\n      case 'getServers':\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        const servers = this.client?.guilds.cache.map((g) => ({ label: g.name, value: g.id })) || [];\n        this.log.debug(`Servers: ${servers.map((i) => i.value)}`);\n        this.sendTo(obj.from, obj.command, servers, obj.callback);\n        break;\n\n      case 'getServerRoles':\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (!this.client) {\n          this.sendTo(obj.from, obj.command, [], obj.callback);\n          return;\n        }\n\n        const guildRolesWithLabel = [];\n        for (const [, guild] of this.client.guilds.cache) {\n          for (const [, role] of guild.roles.cache) {\n            guildRolesWithLabel.push({\n              label: `${guild.name} - ${role.name}`,\n              value: `${guild.id}|${role.id}`,\n            });\n          }\n        }\n\n        this.log.debug(`Server roles: ${guildRolesWithLabel.map((i) => i.value)}`);\n        this.sendTo(obj.from, obj.command, guildRolesWithLabel, obj.callback);\n\n        break;\n\n      case 'getAddToServerLink':\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n        if (this.client?.user?.id) {\n          const perms = new Permissions([\n            Permissions.FLAGS.CHANGE_NICKNAME,\n            Permissions.FLAGS.VIEW_CHANNEL,\n            Permissions.FLAGS.MODERATE_MEMBERS,\n            Permissions.FLAGS.SEND_MESSAGES,\n            Permissions.FLAGS.EMBED_LINKS,\n            Permissions.FLAGS.ATTACH_FILES,\n            Permissions.FLAGS.READ_MESSAGE_HISTORY,\n            Permissions.FLAGS.MENTION_EVERYONE,\n            Permissions.FLAGS.ADD_REACTIONS,\n            Permissions.FLAGS.MUTE_MEMBERS,\n            Permissions.FLAGS.DEAFEN_MEMBERS,\n            Permissions.FLAGS.MOVE_MEMBERS,\n          ]);\n          this.sendTo(obj.from, obj.command, `https://discord.com/api/oauth2/authorize?client_id=${this.client.user.id}&permissions=${perms.bitfield}&scope=bot%20applications.commands`, obj.callback);\n        } else {\n          this.sendTo(obj.from, obj.command, `- ${i18n.getString('Error: The Bot is not connected to Discord!')} -`, obj.callback);\n        }\n        break;\n\n      case 'logConfiguredCommandObjects':\n        this.discordSlashCommands.logConfiguredCommandObjects();\n        if (obj.callback) {\n          this.sendTo(obj.from, obj.command, { result: 'ok' }, obj.callback);\n        }\n        break;\n\n      case 'send':\n      case 'sendMessage':\n        /*\n         * send a message\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const sendPayload = obj.message as SendToActionSendPayload;\n\n        // check payload\n        if (!sendPayload.content || (typeof sendPayload.content !== 'string' && typeof sendPayload.content !== 'object')) {\n          this.sendTo(obj.from, obj.command, { error: 'content needs to be a string or a MessageOptions object', ...sendPayload }, obj.callback);\n          return;\n        }\n\n        if (sendPayload.userId || sendPayload.userTag) {\n          // send to a user\n          if (sendPayload.userId) {\n            // by userId\n            user = this.client?.users.cache.get(sendPayload.userId);\n            if (!user) {\n              this.sendTo(obj.from, obj.command, { error: `No user with userId ${sendPayload.userId} found`, ...sendPayload }, obj.callback);\n              return;\n            }\n          } else {\n            // by userTag\n            user = this.client?.users.cache.find((u) => u.tag === sendPayload.userTag);\n            if (!user) {\n              this.sendTo(obj.from, obj.command, { error: `No user with userTag ${sendPayload.userTag} found`, ...sendPayload }, obj.callback);\n              return;\n            }\n          }\n          try {\n            msg = await user.send(sendPayload.content);\n            this.sendTo(obj.from, obj.command, { result: `Message sent to user ${user.tag}`, ...sendPayload, messageId: msg.id }, obj.callback);\n          } catch (err) {\n            this.sendTo(obj.from, obj.command, { error: `Error sending message to user ${user.tag}: ${err}`, ...sendPayload }, obj.callback);\n          }\n\n        } else if (sendPayload.serverId && sendPayload.channelId) {\n          // send to a channel\n          channel = this.client?.guilds.cache.get(sendPayload.serverId)?.channels.cache.get(sendPayload.channelId);\n          if (!channel?.isText()) {\n            this.sendTo(obj.from, obj.command, { error: `No text channel with channelId ${sendPayload.channelId} on server ${sendPayload.serverId} found`, ...sendPayload }, obj.callback);\n            return;\n          }\n          try {\n            msg = await channel.send(sendPayload.content);\n            this.sendTo(obj.from, obj.command, { result: `Message sent to channel ${channel.name}`, ...sendPayload, messageId: msg.id }, obj.callback);\n          } catch (err) {\n            this.sendTo(obj.from, obj.command, { error: `Error sending message to channel ${channel.name}: ${err}`, ...sendPayload }, obj.callback);\n          }\n\n        } else {\n          // missing arguments\n          this.sendTo(obj.from, obj.command, { error: 'userId, userTag or serverId and channelId needs to be set', ...sendPayload }, obj.callback);\n        }\n\n        break; // send / sendMessage\n\n      case 'editMessage':\n        /*\n         * edit a message\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const editMessagePayload = obj.message as SendToActionEditMessagePayload;\n\n        // check payload\n        if (!editMessagePayload.content || (typeof editMessagePayload.content !== 'string' && typeof editMessagePayload.content !== 'object')) {\n          this.sendTo(obj.from, obj.command, { error: 'content needs to be a string or a MessageOptions object', ...editMessagePayload }, obj.callback);\n          return;\n        }\n\n        // try to get the message\n        try {\n          msg = await this.getPreviousMessage(editMessagePayload);\n        } catch (err) {\n          if (err instanceof Error && err.message) {\n            this.sendTo(obj.from, obj.command, { error: err.message, ...editMessagePayload }, obj.callback);\n          } else {\n            this.sendTo(obj.from, obj.command, { error: err, ...editMessagePayload }, obj.callback);\n          }\n          return;\n        }\n\n        // try to edit the message\n        try {\n          if (!msg.editable) {\n            this.sendTo(obj.from, obj.command, { error: `Message with messageId ${editMessagePayload.messageId} is not editable`, ...editMessagePayload }, obj.callback);\n            return;\n          }\n          await msg.edit(editMessagePayload.content);\n          this.sendTo(obj.from, obj.command, { result: `Message edited`, ...editMessagePayload }, obj.callback);\n        } catch (err) {\n          this.sendTo(obj.from, obj.command, { error: `Error editing message: ${err}`, ...editMessagePayload }, obj.callback);\n        }\n\n        break; // editMessage\n\n      case 'deleteMessage':\n        /*\n         * delete a message\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const deleteMessagePayload = obj.message as MessageIdentifier;\n\n        // try to get the message\n        try {\n          msg = await this.getPreviousMessage(deleteMessagePayload);\n        } catch (err) {\n          if (err instanceof Error && err.message) {\n            this.sendTo(obj.from, obj.command, { error: err.message, ...deleteMessagePayload }, obj.callback);\n          } else {\n            this.sendTo(obj.from, obj.command, { error: err, ...deleteMessagePayload }, obj.callback);\n          }\n          return;\n        }\n\n        // try to delete the message\n        try {\n          if (!msg.deletable) {\n            this.sendTo(obj.from, obj.command, { error: `Message with messageId ${deleteMessagePayload.messageId} is not deletable`, ...deleteMessagePayload }, obj.callback);\n            return;\n          }\n          await msg.delete();\n          this.sendTo(obj.from, obj.command, { result: `Message deleted`, ...deleteMessagePayload }, obj.callback);\n        } catch (err) {\n          this.sendTo(obj.from, obj.command, { error: `Error deleting message: ${err}`, ...deleteMessagePayload }, obj.callback);\n        }\n\n        break; // deleteMessage\n\n      case 'addReaction':\n        /*\n         * add a reaction emoji to a message\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const addReactionPayload = obj.message as SendToActionAddReactionPayload;\n\n        // check payload\n        if (typeof addReactionPayload.emoji !== 'string') {\n          this.sendTo(obj.from, obj.command, { error: 'emoji needs to be a string', ...addReactionPayload }, obj.callback);\n          return;\n        }\n\n        // try to get the message\n        try {\n          msg = await this.getPreviousMessage(addReactionPayload);\n        } catch (err) {\n          if (err instanceof Error && err.message) {\n            this.sendTo(obj.from, obj.command, { error: err.message, ...addReactionPayload }, obj.callback);\n          } else {\n            this.sendTo(obj.from, obj.command, { error: err, ...addReactionPayload }, obj.callback);\n          }\n          return;\n        }\n\n        // try to add the reaction to the message\n        try {\n          await msg.react(addReactionPayload.emoji);\n          this.sendTo(obj.from, obj.command, { result: `Reaction added to message`, ...addReactionPayload }, obj.callback);\n        } catch (err) {\n          this.sendTo(obj.from, obj.command, { error: `Error adding reaction to message: ${err}`, ...addReactionPayload }, obj.callback);\n        }\n\n        break; // addReaction\n\n      case 'awaitMessageReaction':\n        /*\n         * wait for a message reaction\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const awaitMessageReactionPayload = obj.message as SendToActionAwaitMessageReactionPayload;\n\n        // check payload\n        if (typeof awaitMessageReactionPayload.timeout !== 'number' || awaitMessageReactionPayload.timeout < 100 || awaitMessageReactionPayload.timeout > 60000) {\n          this.sendTo(obj.from, obj.command, { error: 'timeout needs to be a number between 100 and 60000', ...awaitMessageReactionPayload }, obj.callback);\n          return;\n        }\n        if (typeof awaitMessageReactionPayload.max !== 'number' || awaitMessageReactionPayload.max < 1) {\n          awaitMessageReactionPayload.max = 1;\n        }\n\n        // try to get the message\n        try {\n          msg = await this.getPreviousMessage(awaitMessageReactionPayload);\n        } catch (err) {\n          if (err instanceof Error && err.message) {\n            this.sendTo(obj.from, obj.command, { error: err.message, ...awaitMessageReactionPayload }, obj.callback);\n          } else {\n            this.sendTo(obj.from, obj.command, { error: err, ...awaitMessageReactionPayload }, obj.callback);\n          }\n          return;\n        }\n\n        // collect reactions\n        const reactionCollector = msg.createReactionCollector({\n          filter: (_reaction, user) => user.id !== this.client?.user?.id,\n          max: awaitMessageReactionPayload.max,\n          time: awaitMessageReactionPayload.timeout,\n        });\n        reactionCollector.on('end', (collected) => {\n          const reactions = collected.map((r) => ({ emoji: r.emoji.name, emojiId: r.emoji.id, users: r.users.cache.map((u) => ({ id: u.id, tag: u.tag })) }));\n          this.sendTo(obj.from, obj.command, { reactions, ...awaitMessageReactionPayload }, obj.callback);\n        });\n\n        break; // awaitMessageReaction\n\n      case 'sendCustomCommandReply':\n        /*\n         * send a reply to a custom slash command\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const sendCustomCommandReplyPayload = obj.message as SendToActionSendCustomCommandReplyPayload;\n\n        // check payload\n        if (typeof sendCustomCommandReplyPayload.interactionId !== 'string') {\n          this.sendTo(obj.from, obj.command, { error: 'interactionId needs to be a string', ...sendCustomCommandReplyPayload }, obj.callback);\n          return;\n        }\n        if (!sendCustomCommandReplyPayload.content || (typeof sendCustomCommandReplyPayload.content !== 'string' && typeof sendCustomCommandReplyPayload.content !== 'object')) {\n          this.sendTo(obj.from, obj.command, { error: 'content needs to be a string or a MessageOptions object', ...sendCustomCommandReplyPayload }, obj.callback);\n          return;\n        }\n\n        // send the reply\n        try {\n          const messageId = await this.discordSlashCommands.sendCmdCustomReply(sendCustomCommandReplyPayload.interactionId, sendCustomCommandReplyPayload.content);\n          this.sendTo(obj.from, obj.command, { result: `Reply sent`, ...sendCustomCommandReplyPayload, messageId }, obj.callback);\n        } catch (err) {\n          this.sendTo(obj.from, obj.command, { error: `Error sending reply: ${err}`, ...sendCustomCommandReplyPayload }, obj.callback);\n        }\n\n        break; // sendCustomCommandReply\n\n      case 'leaveServer':\n        /*\n         * let the bot leave a server\n         */\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const leaveServerPayload = obj.message as SendToActionServerIdentifier;\n\n        // check payload\n        if (!leaveServerPayload.serverId) {\n          this.sendTo(obj.from, obj.command, { error: 'serverId needs to be set', ...leaveServerPayload }, obj.callback);\n          return;\n        }\n\n        const guildToLeave = this.client?.guilds.cache.get(leaveServerPayload.serverId);\n        if (!guildToLeave) {\n          this.sendTo(obj.from, obj.command, { error: `No server with ID ${leaveServerPayload.serverId} found` }, obj.callback);\n          return;\n        }\n\n        try {\n          await guildToLeave.leave();\n          this.log.info(`Left server ${guildToLeave.name} (${guildToLeave.id})`);\n\n          if (obj.callback) {\n            this.sendTo(obj.from, obj.command, { result: 'ok' }, obj.callback);\n          }\n        } catch (err) {\n          if (obj.callback) {\n            this.sendTo(obj.from, obj.command, { error: `Error leaving server ${leaveServerPayload.serverId}: ${err}`, ...leaveServerPayload }, obj.callback);\n          }\n        }\n\n        break;\n\n      case 'getServerInfo':\n        /*\n         * get information about a server\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const getServerInfoPayload = obj.message as SendToActionServerIdentifier;\n\n        // check payload\n        if (!getServerInfoPayload.serverId) {\n          this.sendTo(obj.from, obj.command, { error: 'serverId needs to be set', ...getServerInfoPayload }, obj.callback);\n          return;\n        }\n\n        const server = this.client?.guilds.cache.get(getServerInfoPayload.serverId);\n        if (!server) {\n          this.sendTo(obj.from, obj.command, { error: `No server with ID ${getServerInfoPayload.serverId} found`, ...getServerInfoPayload }, obj.callback);\n          return;\n        }\n\n        this.sendTo(obj.from, obj.command, {\n          id: server.id,\n          name: server.name,\n          description: server.description,\n          members: server.members.cache.map((m) => ({\n            id: m.id,\n            tag: m.user.tag,\n            displayName: m.displayName,\n          })),\n          roles: server.roles.cache.map((r) => ({\n            id: r.id,\n            name: r.name,\n            color: r.hexColor,\n          })),\n          channels: server.channels.cache.map((c) => ({\n            id: c.id,\n            parentId: c.parentId,\n            name: c.name,\n            type: c.type,\n          })),\n        }, obj.callback);\n\n        break; // getServerInfo\n\n      case 'getChannelInfo':\n        /*\n         * get information about a channel\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const getChannelInfoPayload = obj.message as SendToActionChannelIdentifier;\n\n        // check payload\n        if (!getChannelInfoPayload.serverId || !getChannelInfoPayload.channelId) {\n          this.sendTo(obj.from, obj.command, { error: 'serverId and channelId need to be set', ...getChannelInfoPayload }, obj.callback);\n          return;\n        }\n\n        channel = this.client?.guilds.cache.get(getChannelInfoPayload.serverId)?.channels.cache.get(getChannelInfoPayload.channelId);\n        if (!channel) {\n          this.sendTo(obj.from, obj.command, { error: `No channel with ID ${getChannelInfoPayload.channelId} for server with ID ${getChannelInfoPayload.serverId} found`, ...getChannelInfoPayload }, obj.callback);\n          return;\n        }\n\n        this.sendTo(obj.from, obj.command, {\n          id: channel.id,\n          parentId: channel.parentId,\n          name: channel.name,\n          type: channel.type,\n          members: !channel.isThread() && channel.members.map((m) => ({\n            id: m.id,\n            tag: m.user.tag,\n            displayName: m.displayName,\n          })),\n        }, obj.callback);\n\n        break; // getChannelInfo\n\n      case 'getServerMemberInfo':\n        /*\n         * get information about a server member\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const getServerMemberInfoPayload = obj.message as SendToActionServerMemberIdentifier;\n\n        // check payload\n        if (!getServerMemberInfoPayload.serverId || (!getServerMemberInfoPayload.userId && !getServerMemberInfoPayload.userTag)) {\n          this.sendTo(obj.from, obj.command, { error: 'serverId and userlId or userTag need to be set', ...getServerMemberInfoPayload }, obj.callback);\n          return;\n        }\n\n        let member: GuildMember | undefined;\n        if (getServerMemberInfoPayload.userId) {\n          member = this.client?.guilds.cache.get(getServerMemberInfoPayload.serverId)?.members.cache.get(getServerMemberInfoPayload.userId);\n          if (!member) {\n            this.sendTo(obj.from, obj.command, { error: `No member with ID ${getServerMemberInfoPayload.userId} for server with ID ${getServerMemberInfoPayload.serverId} found`, ...getServerMemberInfoPayload }, obj.callback);\n            return;\n          }\n        } else {\n          member = this.client?.guilds.cache.get(getServerMemberInfoPayload.serverId)?.members.cache.find((m) => m.user.tag === getServerMemberInfoPayload.userTag);\n          if (!member) {\n            this.sendTo(obj.from, obj.command, { error: `No member with tag ${getServerMemberInfoPayload.userTag} for server with ID ${getServerMemberInfoPayload.serverId} found`, ...getServerMemberInfoPayload }, obj.callback);\n            return;\n          }\n        }\n\n        this.sendTo(obj.from, obj.command, {\n          id: member.id,\n          tag: member.user.tag,\n          displayName: member.displayName,\n          displayColor: member.displayHexColor,\n          displayAvatarUrl: member.displayAvatarURL(),\n          roles: member.roles.cache.map((r) => ({\n            id: r.id,\n            name: r.name,\n            color: r.hexColor,\n          })),\n          joinedAt: member.joinedTimestamp,\n          voiceChannelId: member.voice.channelId,\n          voiceMuted: member.voice.mute,\n          voiceDeaf: member.voice.deaf,\n        }, obj.callback);\n\n        break; // getServerMemberInfo\n\n      case 'getUserInfo':\n        /*\n         * get information about a user\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const getUserInfoPayload = obj.message as SendToActionUserIdentifier;\n\n        // check payload\n        if (!getUserInfoPayload.userId && !getUserInfoPayload.userTag) {\n          this.sendTo(obj.from, obj.command, { error: 'userlId needs to be set', ...getUserInfoPayload }, obj.callback);\n          return;\n        }\n\n        if (getUserInfoPayload.userId) {\n          user = this.client?.users.cache.get(getUserInfoPayload.userId);\n          if (!user) {\n            this.sendTo(obj.from, obj.command, { error: `No user with ID ${getUserInfoPayload.userId} found`, ...getUserInfoPayload }, obj.callback);\n            return;\n          }\n        } else {\n          user = this.client?.users.cache.find((u) => u.tag === getUserInfoPayload.userTag);\n          if (!user) {\n            this.sendTo(obj.from, obj.command, { error: `No user with tag ${getUserInfoPayload.userTag} found`, ...getUserInfoPayload }, obj.callback);\n            return;\n          }\n        }\n\n        this.sendTo(obj.from, obj.command, {\n          id: user.id,\n          tag: user.tag,\n          avatarUrl: user.avatarURL(),\n          bot: user.bot,\n          accentColor: user.hexAccentColor,\n        }, obj.callback);\n\n        break; // getUserInfo\n\n      case 'getMessageInfo':\n        /*\n         * get information about a message\n         */\n        if (!obj.callback) {\n          this.log.warn(`Message '${obj.command}' called without callback!`);\n          return;\n        }\n\n        if (typeof obj.message !== 'object') {\n          this.sendTo(obj.from, obj.command, { error: 'sendTo message needs to be an object' }, obj.callback);\n          return;\n        }\n\n        const getMessageInfoPayload = obj.message as MessageIdentifier;\n\n        try {\n          msg = await this.getPreviousMessage(getMessageInfoPayload);\n        } catch (err) {\n          if (err instanceof Error && err.message) {\n            this.sendTo(obj.from, obj.command, { error: err.message, ...getMessageInfoPayload }, obj.callback);\n          } else {\n            this.sendTo(obj.from, obj.command, { error: err, ...getMessageInfoPayload }, obj.callback);\n          }\n          return;\n        }\n\n        this.sendTo(obj.from, obj.command, {\n          id: msg.id,\n          author: {\n            id: msg.author.id,\n            tag: msg.author.tag,\n          },\n          content: msg.content,\n          embeds: msg.embeds.map((e) => e.toJSON()),\n          attachments: msg.attachments.map((a) => a.toJSON()),\n          reactions: msg.reactions.cache.map((r) => r.toJSON()),\n          createdTimestamp: msg.createdTimestamp,\n          editedTimestamp: msg.editedTimestamp,\n          reference: msg.reference,\n        }, obj.callback);\n\n        break; // getMessageInfo\n\n      default:\n        /*\n         * unknown command\n         */\n        this.log.warn(`Got message with unknown command: ${obj.command}`);\n        if (obj.callback) {\n          this.sendTo(obj.from, obj.command, { error: `Unknown command: ${obj.command}` }, obj.callback);\n        }\n\n    }\n  }\n\n  /**\n   * Try to detect and parse stringified JSON MessageOptions.\n   *\n   * If the `content` starts/ends with curly braces if will be treated as\n   * stringified JSON. Then the JSON will be parsed and some basic checks will\n   * be run against the parsed object.\n   *\n   * Otherwise the content will be treated as a simple string and wrapped into\n   * a `MessageOptions` object.\n   * @param content The stringified content to be parsed.\n   * @returns A `MessageOptions` object.\n   * @throws An error if parsing JSON or a check failed.\n   */\n  public parseStringifiedMessageOptions (content: string): MessageOptions {\n    let mo: MessageOptions;\n\n    if (content.startsWith('{') && content.endsWith('}')) {\n      // seams to be json\n      this.log.debug(`Content seams to be json`);\n\n      try {\n        mo = JSON.parse(content) as MessageOptions;\n      } catch (err) {\n        throw new Error(`Content seams to be json but cannot be parsed!`);\n      }\n\n      // do some basic checks against the parsed object\n      if ((!mo?.files && !mo.content) || (mo.files && !Array.isArray(mo.files)) || (mo.embeds && !Array.isArray(mo.embeds))) {\n        throw new Error(`Content is json but seams to be invalid!`);\n      }\n\n    } else {\n      // just a string... create MessageOptions object\n      mo = {\n        content,\n      };\n    }\n\n    return mo;\n  }\n\n  /**\n   * Find a previous message from/to a user or in a server text channel.\n   * @param identifier Parameters to find the message.\n   * @throws An error if some parameters are missing or the message could not be found.\n   */\n  private async getPreviousMessage (identifier: MessageIdentifier): Promise<Message<boolean>> {\n    if (!identifier.messageId) {\n      throw new Error('messageId needs to be set');\n    }\n\n    if (identifier.userId || identifier.userTag) {\n      // a user\n      let user: User | undefined;\n      if (identifier.userId) {\n        // by userId\n        user = this.client?.users.cache.get(identifier.userId);\n        if (!user) {\n          throw new Error(`No user with userId ${identifier.userId} found`);\n        }\n      } else {\n        // by userTag\n        user = this.client?.users.cache.find((u) => u.tag === identifier.userTag);\n        if (!user) {\n          throw new Error(`No user with userTag ${identifier.userTag} found`);\n        }\n      }\n      try {\n        if (!user.dmChannel) {\n          await user.createDM();\n        }\n        const msg = user.dmChannel?.messages.cache.get(identifier.messageId) || await user.dmChannel?.messages.fetch(identifier.messageId);\n        if (!msg) {\n          throw new Error(`No message with messageId ${identifier.messageId} for user ${user.tag} found`);\n        }\n        return msg;\n      } catch (err) {\n        throw new Error(`Error finding message for user ${user.tag}: ${err}`);\n      }\n\n    } else if (identifier.serverId && identifier.channelId) {\n      // a channel\n      const channel = this.client?.guilds.cache.get(identifier.serverId)?.channels.cache.get(identifier.channelId);\n      if (!channel?.isText()) {\n        throw new Error(`No text channel with channelId ${identifier.channelId} on server ${identifier.serverId} found`);\n      }\n      try {\n        const msg = channel.messages.cache.get(identifier.messageId) || await channel.messages.fetch(identifier.messageId);\n        if (!msg) {\n          throw new Error(`No message with messageId ${identifier.messageId} for channel ${channel.name} found`);\n        }\n        return msg;\n      } catch (err) {\n        throw new Error(`Error finding message in channel ${channel.name}: ${err}`);\n      }\n\n    } else {\n      // missing arguments\n      throw new Error('userId, userTag or serverId and channelId needs to be set');\n    }\n  }\n\n  /**\n   * Check if a user or guild member is authorized to do something.\n   * For guild members their roles will also be checked.\n   * @param user The User or GuildMember to check.\n   * @param required Object containing the required flags. If not provided the check returns if the user in the list of authorized users.\n   * @returns `true` if the user is authorized or authorization is not enabled, `false` otherwise\n   */\n  public checkUserAuthorization (user: User | GuildMember, required?: CheckAuthorizationOpts): boolean {\n    if (!this.config.enableAuthorization) {\n      return true;\n    }\n\n    // get direct user flags\n    let given: ioBroker.AdapterConfigAuthorizedFlags | undefined = this.config.authorizedUsers.find((au) => au.userId === user.id);\n\n    // for guild members find role flags and merge them all together\n    if (this.config.authorizedServerRoles.length > 0 && user instanceof GuildMember) {\n      for (const [, role] of user.roles.cache) {\n        const roleGiven = this.config.authorizedServerRoles.find((ar) => ar.serverAndRoleId === `${user.guild.id}|${role.id}`);\n        if (roleGiven) {\n          if (!given) {\n            given = roleGiven;\n          } else {\n            given = {\n              getStates:  given.getStates || roleGiven.getStates,\n              setStates:  given.setStates || roleGiven.setStates,\n              useCustomCommands:  given.useCustomCommands || roleGiven.useCustomCommands,\n              useText2command:  given.useText2command || roleGiven.useText2command,\n            };\n          }\n        }\n      }\n    }\n\n    // nothing found?\n    if (!given) {\n      return false;\n    }\n\n    // if no required flags given just return true if something found\n    if (!required) {\n      return true;\n    }\n\n    if ((required.getStates && !given.getStates)\n        || (required.setStates && !given.setStates)\n        || (required.useCustomCommands && !given.useCustomCommands)\n        || (required.useText2command && !given.useText2command)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Awaitable function to just wait some time.\n   *\n   * Uses `Adapter.setTimeout(...)` internally to make sure the timeout is cleared on adapter unload.\n   * @param time Time to wait in ms.\n   */\n  public wait (time: number): Promise<void> {\n    return new Promise((resolve) => this.setTimeout(resolve, time));\n  }\n\n  /**\n   * Set the `info.connection` state if changed.\n   * @param connected If connected.\n   * @param force `true` to skip local cache check and always set the state.\n   */\n  private async setInfoConnectionState (connected: boolean, force: boolean = false): Promise<void> {\n    if (force || connected !== this.infoConnected) {\n      await this.setStateAsync('info.connection', connected, true);\n      this.infoConnected = connected;\n    }\n  }\n\n  /**\n   * Internal replacemend for `extendObjectAsync(...)` which compares the given\n   * object for each `id` against a cached version and only calls na original\n   * `extendObjectAsync(...)` if the object changed.\n   * Using this, the object gets only updated if\n   *  a) it's the first call for this `id` or\n   *  b) the object needs to be changed.\n   */\n  public async extendObjectAsyncCached (id: string, objPart: ioBroker.PartialObject, options?: ioBroker.ExtendObjectOptions): ioBroker.SetObjectPromise {\n    const cachedObj: ioBroker.PartialObject | undefined = this.extendObjectCache.get(id);\n\n    if (isDeepStrictEqual(cachedObj, objPart)) {\n      return { id };\n    }\n\n    const ret = await this.extendObjectAsync(id, objPart, options);\n    this.extendObjectCache.set(id, objPart);\n    return ret;\n  }\n\n  /**\n   * Internal replacement for `delObjectAsync(...)` which also removes the local\n   * cache entry for the given `id`.\n   */\n  public async delObjectAsyncCached (id: string, options?: ioBroker.DelObjectOptions): Promise<void> {\n    if (options?.recursive) {\n      this.extendObjectCache.filter((_obj, id2) => id2.startsWith(id)).each((_obj, id2) => this.extendObjectCache.delete(id2));\n    } else {\n      this.extendObjectCache.delete(id);\n    }\n\n    return this.delObjectAsync(id, options);\n  }\n\n  /**\n   * Is called when adapter shuts down - callback has to be called under any circumstances!\n   */\n  @boundMethod\n  private async onUnload (callback: () => void): Promise<void> {\n    try {\n      this.unloaded = true;\n\n      await this.setInfoConnectionState(false, true);\n\n      if (this.client) {\n        this.client.destroy();\n      }\n\n      callback();\n    } catch (e) {\n      callback();\n    }\n  }\n\n}\n\nif (require.main !== module) {\n  // Export the constructor in compact mode\n  module.exports = (options: Partial<AdapterOptions> | undefined) => new DiscordAdapter(options);\n} else {\n  // otherwise start the instance directly\n  (() => new DiscordAdapter())();\n}\n\n// export the type of the adapter class to use it in other files\nexport type { DiscordAdapter };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA,sBAAO;AAEP,uBAAkC;AAElC,gCAA4B;AAE5B,0BAIO;AAEP,qBAiBO;AAEP,sBAGO;AACP,yBAsBO;AACP,kBAAqB;AACrB,mBAGO;AAEP,MAAM,mBAA0B;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAKA,MAAM,uBAAuB,4BAAQ;AAAA,EAyD5B,YAAY,UAAmC,CAAC,GAAG;AACxD,UAAM,iCACD,UADC;AAAA,MAEJ,MAAM;AAAA,IACR,EAAC;AAxDK,yBAAyB;AAK1B,kBAAwB;AAMvB,gCAAoC,oBAAI,IAAI;AAM5C,sBAA6B,oBAAI,IAAI;AAKrC,+BAAmC,oBAAI,IAAI;AAK3C,6BAAgE,IAAI,0BAAW;AAK/E,0BAAqH,IAAI,0BAAW;AAYrI,wCAAwC;AAMxC,oBAAoB;AAQzB,SAAK,uBAAuB,IAAI,4CAA4B,IAAI;AAEhE,SAAK,GAAG,SAAS,KAAK,OAAO;AAC7B,SAAK,GAAG,eAAe,KAAK,aAAa;AACzC,SAAK,GAAG,gBAAgB,KAAK,cAAc;AAC3C,SAAK,GAAG,WAAW,KAAK,SAAS;AACjC,SAAK,GAAG,UAAU,KAAK,QAAQ;AAAA,EACjC;AAAA,QAMc,UAAyB;AA7JzC;AAgKI,UAAM,KAAK,uBAAuB,OAAO,IAAI;AAG7C,UAAM,eAAe,MAAM,KAAK,sBAAsB,eAAe;AACrE,qBAAK,WAAW,8CAAc,OAAO,aAAY;AACjD,qBAAK,eAAe,8CAAc,OAAO,iBAAgB;AAGzD,QAAI,OAAO,KAAK,OAAO,UAAU,YAAY,CAAC,KAAK,OAAO,MAAM,MAAM,6DAA6D,GAAG;AACpI,WAAK,IAAI,MAAM,sBAAsB;AACrC;AAAA,IACF;AACA,QAAI,CAAC,MAAM,QAAQ,KAAK,OAAO,eAAe,GAAG;AAC/C,WAAK,OAAO,kBAAkB,CAAC;AAAA,IACjC;AACA,QAAI,CAAC,MAAM,QAAQ,KAAK,OAAO,qBAAqB,GAAG;AACrD,WAAK,OAAO,wBAAwB,CAAC;AAAA,IACvC;AACA,QAAI,CAAC,KAAK,OAAO,qBAAqB;AACpC,WAAK,IAAI,KAAK,0KAA0K;AAAA,IAC1L;AACA,QAAI,KAAK,OAAO,uBAAuB,KAAK,OAAO,gBAAgB,WAAW,KAAK,KAAK,OAAO,sBAAsB,WAAW,GAAG;AACjI,WAAK,IAAI,KAAK,+DAA+D;AAAA,IAC/E;AACA,QAAI,KAAK,OAAO,wBAAwB,CAAC,MAAM,QAAQ,KAAK,OAAO,cAAc,GAAG;AAClF,WAAK,OAAO,iBAAiB,CAAC;AAAA,IAChC;AACA,SAAK,OAAO,uBAAuB,YAAK,OAAO,yBAAZ,mBAAkC,WAAU;AAG/E,QAAI,KAAK,OAAO,iBAAiB;AAC/B,YAAM,KAAK,kBAAkB,OAAO;AAAA,QAClC,MAAM;AAAA,QACN,QAAQ;AAAA,UACN,MAAM,iBAAK,sBAAsB,UAAU;AAAA,QAC7C;AAAA,QACA,QAAQ,CAAC;AAAA,MACX,CAAC;AACD,YAAM,QAAQ,IAAI;AAAA,QAChB,KAAK,kBAAkB,uBAAuB;AAAA,UAC5C,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,4BAA4B;AAAA,YAC7D,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,kBAAkB,mBAAmB;AAAA,UACxC,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,wBAAwB;AAAA,YACzD,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,MACH,CAAC;AAAA,IACH,OAAO;AACL,YAAM,KAAK,eAAe,OAAO,EAAE,WAAW,KAAK,CAAC;AAAA,IACtD;AAEA,QAAI,KAAK,OAAO,sBAAsB;AACpC,YAAM,KAAK,kBAAkB,iBAAiB;AAAA,QAC5C,MAAM;AAAA,QACN,QAAQ;AAAA,UACN,MAAM,iBAAK,sBAAsB,+BAA+B;AAAA,QAClE;AAAA,QACA,QAAQ,CAAC;AAAA,MACX,CAAC;AAAA,IACH,OAAO;AACL,YAAM,KAAK,eAAe,iBAAiB,EAAE,WAAW,KAAK,CAAC;AAAA,IAChE;AAGA,SAAK,SAAS,IAAI,sBAAO;AAAA,MACvB,SAAS;AAAA,QACP,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,QACd,uBAAQ,MAAM;AAAA,MAChB;AAAA,MACA,UAAU;AAAA,QACR;AAAA,MACF;AAAA,IACF,CAAC;AAED,SAAK,OAAO,GAAG,SAAS,KAAK,aAAa;AAE1C,QAAI,KAAK,IAAI,UAAU,SAAS;AAC9B,WAAK,OAAO,GAAG,SAAS,CAAC,YAAY,KAAK,IAAI,MAAM,cAAc,SAAS,CAAC;AAAA,IAC9E;AACA,SAAK,OAAO,GAAG,QAAQ,CAAC,YAAY,KAAK,IAAI,KAAK,2BAA2B,SAAS,CAAC;AACvF,SAAK,OAAO,GAAG,SAAS,CAAC,QAAQ,KAAK,IAAI,MAAM,yBAAyB,IAAI,SAAS,GAAG,CAAC;AAC1F,SAAK,OAAO,GAAG,aAAa,CAAC,kBAAkB,KAAK,IAAI,MAAM,kCAAkC,KAAK,UAAU,aAAa,GAAG,CAAC;AAChI,SAAK,OAAO,GAAG,yBAAyB,CAAC,8BAA8B,KAAK,IAAI,KAAK,2CAA2C,KAAK,UAAU,yBAAyB,GAAG,CAAC;AAE5K,SAAK,OAAO,GAAG,eAAe,MAAM;AAClC,WAAK,IAAI,KAAK,oCAAoC;AAClD,WAAK,uBAAuB,KAAK;AAAA,IACnC,CAAC;AAED,SAAK,OAAO,GAAG,cAAc,CAAC,QAAQ;AAGpC,WAAK,IAAI,KAAK,mCAAmC,IAAI,SAAS,GAAG;AACjE,WAAK,uBAAuB,KAAK;AAAA,IACnC,CAAC;AACD,SAAK,OAAO,GAAG,cAAc,CAAC,YAAY;AAExC,WAAK,IAAI,KAAK,+CAA+C,UAAU;AACvE,WAAK,uBAAuB,IAAI;AAChC,WAAK,eAAe;AAAA,IACtB,CAAC;AACD,SAAK,OAAO,GAAG,eAAe,CAAC,SAAS,mBAAmB,KAAK,IAAI,MAAM,4CAA4C,0BAA0B,iBAAiB,CAAC;AAClK,SAAK,OAAO,GAAG,mBAAmB,CAAC,OAAO,YAAY,KAAK,IAAI,MAAM,gDAAgD,WAAW,MAAM,SAAS,CAAC;AAChJ,SAAK,OAAO,GAAG,qBAAqB,CAAC,YAAY,KAAK,IAAI,MAAM,kDAAkD,UAAU,CAAC;AAC7H,SAAK,OAAO,GAAG,cAAc,CAAC,KAAK,YAAY;AAC7C,WAAK,IAAI,MAAM,2CAA2C,YAAY,KAAK;AAC3E,WAAK,UAAU,kCAAkC,+BAAW,6BAA6B;AAAA,IAC3F,CAAC;AAED,SAAK,OAAO,GAAG,iBAAiB,KAAK,qBAAqB;AAE1D,QAAI,KAAK,OAAO,sBAAsB;AACpC,WAAK,OAAO,GAAG,iBAAiB,MAAM,KAAK,aAAa,CAAC;AACzD,WAAK,OAAO,GAAG,iBAAiB,MAAM,KAAK,aAAa,CAAC;AACzD,WAAK,OAAO,GAAG,iBAAiB,MAAM,KAAK,aAAa,CAAC;AACzD,WAAK,OAAO,GAAG,eAAe,MAAM,KAAK,aAAa,CAAC;AACvD,WAAK,OAAO,GAAG,eAAe,MAAM,KAAK,aAAa,CAAC;AACvD,WAAK,OAAO,GAAG,eAAe,MAAM,KAAK,aAAa,CAAC;AACvD,WAAK,OAAO,GAAG,kBAAkB,MAAM,KAAK,aAAa,CAAC;AAC1D,WAAK,OAAO,GAAG,qBAAqB,MAAM,KAAK,aAAa,CAAC;AAC7D,WAAK,OAAO,GAAG,cAAc,MAAM,KAAK,aAAa,CAAC;AACtD,WAAK,OAAO,GAAG,cAAc,MAAM,KAAK,aAAa,CAAC;AACtD,WAAK,OAAO,GAAG,cAAc,MAAM,KAAK,aAAa,CAAC;AACtD,WAAK,OAAO,GAAG,cAAc,MAAM,KAAK,aAAa,CAAC;AAAA,IACxD;AAEA,QAAI,KAAK,OAAO,qBAAqB;AACnC,WAAK,OAAO,GAAG,kBAAkB,CAAC,cAAc,gBAAgB;AAAE,aAAK,mBAAmB,YAAY,QAAQ,WAAW;AAAA,MAAG,CAAC;AAAA,IAC/H;AAEA,QAAI,KAAK,OAAO,uBAAuB;AACrC,WAAK,OAAO,GAAG,oBAAoB,KAAK,wBAAwB;AAAA,IAClE;AAGA,SAAK,qBAAqB,QAAQ;AAGlC,SAAK,gBAAgB,2BAA2B;AAChD,SAAK,gBAAgB,+BAA+B;AACpD,SAAK,gBAAgB,gCAAgC;AACrD,SAAK,gBAAgB,mCAAmC;AACxD,SAAK,gBAAgB,cAAc;AACnC,SAAK,gBAAgB,kBAAkB;AACvC,SAAK,gBAAgB,mBAAmB;AACxC,SAAK,gBAAgB,sBAAsB;AAC3C,SAAK,gBAAgB,qCAAqC;AAC1D,SAAK,gBAAgB,qCAAqC;AAC1D,SAAK,gBAAgB,qCAAqC;AAC1D,SAAK,gBAAgB,2BAA2B;AAChD,SAAK,gBAAgB,OAAO;AAC5B,SAAK,wBAAwB,GAAG;AAGhC,SAAK,IAAI,MAAM,wCAAwC;AACvD,UAAM,OAAO,MAAM,KAAK,mBAAmB,UAAU,UAAU,CAAC,CAAC;AACjE,QAAI,6BAAM,MAAM;AACd,iBAAW,QAAQ,KAAK,MAAM;AAC5B,cAAM,KAAK,eAAe,KAAK,IAAI,WAAK,UAAL,mBAAa,KAAK,UAAU;AAAA,MACjE;AAAA,IACF;AACA,SAAK,IAAI,MAAM,6CAA6C;AAG5D,SAAK,+BAA+B;AAGpC,QAAI,CAAC,MAAM,KAAK,YAAY,GAAG;AAC7B,WAAK,UAAU,4BAA4B,+BAAW,6BAA6B;AACnF;AAAA,IACF;AAGA,UAAM,KAAK,qBAAqB,sBAAsB;AAAA,EACxD;AAAA,QAYc,YAAa,QAAgB,GAAqB;AAC9D,QAAI,CAAC,KAAK,UAAU,KAAK,UAAU;AACjC,aAAO;AAAA,IACT;AAEA,QAAI;AACF,YAAM,KAAK,OAAO,MAAM,KAAK,OAAO,KAAK;AACzC,aAAO;AAAA,IACT,SAAS,KAAP;AACA,UAAI,eAAe,OAAO;AACxB,aAAK,IAAI,MAAM,wBAAwB,IAAI,SAAS,GAAG;AACvD,YAAI,IAAI,SAAS,cAAc;AAE7B;AACA,cAAI,SAAS,iBAAiB,QAAQ;AACpC,oBAAQ,iBAAiB,SAAS;AAAA,UACpC;AAEA,eAAK,IAAI,KAAK,QAAQ,iBAAiB,SAAS,uCAAwC,QAAM,QAAQ;AACtG,gBAAM,KAAK,KAAK,iBAAiB,MAAM;AAEvC,iBAAO,KAAK,YAAY,KAAK;AAAA,QAC/B;AAAA,MACF,OAAO;AACL,aAAK,IAAI,MAAM,6BAA6B;AAAA,MAC9C;AACA,aAAO;AAAA,IACT;AAAA,EACF;AAAA,QAMc,gBAAgC;AArZhD;AAsZI,QAAI,CAAC,YAAK,WAAL,mBAAa,OAAM;AACtB,WAAK,IAAI,MAAM,6BAA6B;AAC5C;AAAA,IACF;AAEA,SAAK,IAAI,KAAK,gBAAgB,KAAK,OAAO,KAAK,MAAM;AACrD,SAAK,IAAI,MAAM,YAAY,KAAK,OAAO,KAAK,IAAI;AAGhD,QAAI,KAAK,OAAO,SAAS;AACvB,UAAI,KAAK,OAAO,KAAK,aAAa,KAAK,OAAO,SAAS;AAErD,aAAK,IAAI,MAAM,6CAA6C,KAAK,OAAO,KAAK,+BAA+B,KAAK,OAAO,SAAS;AACjI,YAAI;AACF,gBAAM,QAAwB,CAAC;AAC/B,gBAAM,KAAK,KAAK,OAAO,KAAK,YAAY,KAAK,OAAO,OAAO,CAAC;AAE5D,qBAAW,CAAC,EAAE,UAAU,KAAK,OAAO,OAAO,OAAO;AAChD,kBAAM,KAAK,MAAM,QAAQ,MAAM,IAAI,KAAK,OAAO,KAAK,EAAE;AACtD,gBAAI,IAAI;AACN,oBAAM,KAAK,GAAG,YAAY,KAAK,OAAO,OAAO,CAAC;AAAA,YAChD;AAAA,UACF;AAEA,gBAAM,QAAQ,IAAI,KAAK;AACvB,eAAK,IAAI,MAAM,kBAAkB;AAAA,QACnC,SAAS,KAAP;AACA,eAAK,IAAI,KAAK,kCAAkC,KAAK,OAAO,aAAa,KAAK;AAAA,QAChF;AAAA,MACF,OAAO;AAEL,aAAK,IAAI,MAAM,wBAAwB;AAAA,MACzC;AAAA,IACF;AAEA,QAAI;AACF,YAAM,KAAK,aAAa;AAAA,IAC1B,SAAS,KAAP;AACA,WAAK,IAAI,MAAM,4CAA4C,KAAK;AAAA,IAClE;AAAA,EACF;AAAA,QAMc,eAA+B;AApc/C;AAqcI,QAAI,CAAC,YAAK,WAAL,mBAAa,OAAM;AACtB,YAAM,IAAI,MAAM,mBAAmB;AAAA,IACrC;AAMA,UAAM,kBAAoF,IAAI,0BAAW;AAMzG,UAAM,6BAA0C,oBAAI,IAAI;AAExD,QAAI,KAAK;AAAU;AACnB,UAAM,SAAS,MAAM,KAAK,OAAO,OAAO,MAAM;AAC9C,QAAI,KAAK;AAAU;AAEnB,eAAW,CAAC,EAAE,cAAc,QAAQ;AAElC,UAAI,KAAK;AAAU;AACnB,UAAI;AACJ,UAAI;AACF,gBAAQ,MAAM,UAAU,MAAM;AAAA,MAChC,SAAS,KAAP;AACA,aAAK,IAAI,KAAK,gDAAgD,UAAU,YAAY,UAAU,IAAI;AAClG,aAAK,IAAI,MAAM,UAAU,KAAK;AAC9B;AAAA,MACF;AACA,UAAI,KAAK;AAAU;AAEnB,iCAA2B,IAAI,GAAG,KAAK,qBAAqB,MAAM,IAAI;AAGtE,YAAM,KAAK,wBAAwB,WAAW,MAAM,MAAM;AAAA,QACxD,MAAM;AAAA,QACN,QAAQ;AAAA,UACN,MAAM,MAAM;AAAA,QACd;AAAA,QACA,QAAQ,CAAC;AAAA,MACX,CAAC;AAED,YAAM,QAAQ,IAAI;AAAA,QAChB,KAAK,wBAAwB,WAAW,MAAM,cAAc;AAAA,UAC1D,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,SAAS;AAAA,UAC5C;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,WAAW,MAAM,eAAe;AAAA,UAC3D,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,UAAU;AAAA,UAC7C;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,MACH,CAAC;AAGD,YAAM,eAAe,MAAM,MAAM,QAAQ,MAAM;AAC/C,UAAI,KAAK;AAAU;AAEnB,iBAAW,CAAC,EAAE,WAAW,cAAc;AAErC,YAAI,OAAO,KAAK,OAAO,KAAK,OAAO,KAAK,IAAI;AAC1C,0BAAgB,IAAI,OAAO,KAAK,IAAI,EAAE,MAAM,OAAO,MAAM,UAAU,OAAO,SAAS,CAAC;AAAA,QACtF;AAEA,cAAM,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,MAAM;AAAA,UAC7E,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,GAAG,OAAO,gBAAgB,OAAO,KAAK;AAAA,UAC9C;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAED,cAAM,QAAQ,IAAI;AAAA,UAChB,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,UAAU;AAAA,YAC3E,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,UAAU;AAAA,cAC3C,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UACD,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,kBAAkB;AAAA,YACnF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,cAAc;AAAA,cAC/C,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UACD,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,YAAY;AAAA,YAC7E,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,OAAO;AAAA,cACxC,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UAED,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,eAAe;AAAA,YAChF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,WAAW;AAAA,cAC5C,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UAED,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,mBAAmB;AAAA,YACpF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,eAAe;AAAA,cAChD,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UACD,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,sBAAsB;AAAA,YACvF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,kBAAkB;AAAA,cACnD,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UACD,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,oBAAoB;AAAA,YACrF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,mBAAmB;AAAA,cACpD,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UACD,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,sBAAsB;AAAA,YACvF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,qBAAqB;AAAA,cACtD,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UACD,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,oBAAoB;AAAA,YACrF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,iBAAiB;AAAA,cAClD,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UACD,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,sBAAsB;AAAA,YACvF,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,mBAAmB;AAAA,cACpD,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,UAED,KAAK,wBAAwB,WAAW,MAAM,cAAc,OAAO,WAAW;AAAA,YAC5E,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,iBAAK,sBAAsB,WAAW;AAAA,cAC5C,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,cACN,OAAO;AAAA,cACP,KAAK;AAAA,YACP;AAAA,YACA,QAAQ,CAAC;AAAA,UACX,CAAC;AAAA,QACH,CAAC;AAGD,cAAM,cAAc,OAAO,MAAM,MAAM,IAAI,CAAC,SAAS,KAAK,IAAI;AAC9D,cAAM,QAAQ,IAAI;AAAA,UAChB,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,UAAU,OAAO,KAAK,KAAK,IAAI;AAAA,UACxF,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,kBAAkB,OAAO,aAAa,IAAI;AAAA,UACnG,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,YAAY,YAAY,KAAK,IAAI,GAAG,IAAI;AAAA,UACjG,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,eAAe,OAAO,iBAAiB,IAAI;AAAA,UACpG,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,mBAAmB,cAAO,MAAM,YAAb,mBAAsB,SAAQ,IAAI,IAAI;AAAA,UAClH,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,oBAAoB,CAAC,CAAC,OAAO,MAAM,UAAU,IAAI;AAAA,UAC1G,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,sBAAsB,CAAC,CAAC,OAAO,MAAM,YAAY,IAAI;AAAA,UAC9G,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,oBAAoB,CAAC,CAAC,OAAO,MAAM,UAAU,IAAI;AAAA,UAC1G,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,sBAAsB,CAAC,CAAC,OAAO,MAAM,YAAY,IAAI;AAAA,QAChH,CAAC;AAED,cAAM,OAA8B;AAAA,UAClC,KAAK,OAAO,KAAK;AAAA,UACjB,IAAI,OAAO;AAAA,UACX,aAAa,OAAO;AAAA,UACpB,OAAO;AAAA,UACP,QAAQ,OAAO;AAAA,UACf,cAAc,cAAO,MAAM,YAAb,mBAAsB,SAAQ;AAAA,UAC5C,gBAAgB,cAAO,MAAM,YAAb,mBAAsB,OAAM;AAAA,UAC5C,eAAe,CAAC,CAAC,OAAO,MAAM;AAAA,UAC9B,iBAAiB,CAAC,CAAC,OAAO,MAAM;AAAA,UAChC,eAAe,CAAC,CAAC,OAAO,MAAM;AAAA,UAC9B,iBAAiB,CAAC,CAAC,OAAO,MAAM;AAAA,QAClC;AACA,YAAI,CAAC,wCAAkB,MAAM,KAAK,eAAe,IAAI,GAAG,KAAK,qBAAqB,MAAM,cAAc,OAAO,SAAS,CAAC,GAAG;AACxH,gBAAM,KAAK,cAAc,WAAW,MAAM,cAAc,OAAO,WAAW,KAAK,UAAU,IAAI,GAAG,IAAI;AACpG,eAAK,eAAe,IAAI,GAAG,KAAK,qBAAqB,MAAM,cAAc,OAAO,WAAW,IAAI;AAAA,QACjG;AAAA,MAEF;AAGA,UAAI,KAAK;AAAU;AACnB,YAAM,WAAW,MAAM,MAAM,SAAS,MAAM;AAC5C,UAAI,KAAK;AAAU;AAGnB,iBAAW,WAAW,CAAC,MAAM,KAAK,GAAG;AACnC,mBAAW,CAAC,EAAE,YAAY,UAAU;AAClC,cAAK,WAAW,QAAQ,YAAc,CAAC,WAAW,CAAC,QAAQ,UAAW;AACpE;AAAA,UACF;AACA,gBAAM,kBAAkB,UAAU,WAAW,MAAM,eAAe,QAAQ,OAAO,WAAW,MAAM,eAAe,QAAQ,qBAAqB,QAAQ;AAEtJ,qCAA2B,IAAI,GAAG,KAAK,aAAa,iBAAiB;AAErE,cAAI,OAA2B;AAC/B,cAAI,QAAQ,OAAO,GAAG;AACpB,mBAAO;AAAA,UACT;AACA,cAAI,QAAQ,QAAQ,GAAG;AACrB,mBAAO;AAAA,UACT;AACA,gBAAM,KAAK,wBAAwB,iBAAiB;AAAA,YAClD,MAAM;AAAA,YACN,QAAQ;AAAA,cACN,MAAM,QAAQ,SAAS,GAAG,QAAQ,OAAO,UAAU,QAAQ,SAAS,QAAQ;AAAA,cAC5E;AAAA,YACF;AAAA,YACA,QAAQ;AAAA,cACN,WAAW,QAAQ;AAAA,YACrB;AAAA,UACF,CAAC;AACD,cAAI,QAAQ,SAAS,kBAAkB;AACrC,kBAAM,KAAK,wBAAwB,GAAG,4BAA4B;AAAA,cAChE,MAAM;AAAA,cACN,QAAQ;AAAA,gBACN,MAAM,iBAAK,sBAAsB,UAAU;AAAA,cAC7C;AAAA,cACA,QAAQ,CAAC;AAAA,YACX,CAAC;AAAA,UACH;AAEA,gBAAM,QAAQ,IAAI;AAAA,YAChB,KAAK,wBAAwB,GAAG,wBAAwB;AAAA,cACtD,MAAM;AAAA,cACN,QAAQ;AAAA,gBACN,MAAM,iBAAK,sBAAsB,WAAW;AAAA,gBAC5C,MAAM;AAAA,gBACN,MAAM;AAAA,gBACN,MAAM;AAAA,gBACN,OAAO;AAAA,gBACP,KAAK;AAAA,cACP;AAAA,cACA,QAAQ,CAAC;AAAA,YACX,CAAC;AAAA,YACD,KAAK,wBAAwB,GAAG,+BAA+B;AAAA,cAC7D,MAAM;AAAA,cACN,QAAQ;AAAA,gBACN,MAAM,iBAAK,sBAAsB,cAAc;AAAA,gBAC/C,MAAM;AAAA,gBACN,MAAM;AAAA,gBACN,MAAM;AAAA,gBACN,OAAO;AAAA,gBACP,KAAK;AAAA,cACP;AAAA,cACA,QAAQ,CAAC;AAAA,YACX,CAAC;AAAA,YACD,KAAK,wBAAwB,GAAG,2BAA2B;AAAA,cACzD,MAAM;AAAA,cACN,QAAQ;AAAA,gBACN,MAAM,iBAAK,sBAAsB,SAAS;AAAA,gBAC1C,MAAM;AAAA,gBACN,MAAM;AAAA,gBACN,MAAM;AAAA,gBACN,OAAO;AAAA,gBACP,KAAK;AAAA,cACP;AAAA,cACA,QAAQ,CAAC;AAAA,YACX,CAAC;AAAA,UACH,CAAC;AAED,cAAI,QAAQ,OAAO,GAAG;AACpB,kBAAM,QAAQ,IAAI;AAAA,cAChB,KAAK,wBAAwB,GAAG,2BAA2B;AAAA,gBACzD,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,cAAc;AAAA,kBAC/C,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cACD,KAAK,wBAAwB,GAAG,6BAA6B;AAAA,gBAC3D,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,iBAAiB;AAAA,kBAClD,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cACD,KAAK,wBAAwB,GAAG,iCAAiC;AAAA,gBAC/D,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,qBAAqB;AAAA,kBACtD,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cACD,KAAK,wBAAwB,GAAG,oCAAoC;AAAA,gBAClE,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,wBAAwB;AAAA,kBACzD,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cACD,KAAK,wBAAwB,GAAG,+BAA+B;AAAA,gBAC7D,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,wBAAwB;AAAA,kBACzD,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cAED,KAAK,wBAAwB,GAAG,wBAAwB;AAAA,gBACtD,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,cAAc;AAAA,kBAC/C,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cACD,KAAK,wBAAwB,GAAG,4BAA4B;AAAA,gBAC1D,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,WAAW;AAAA,kBAC5C,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cACD,KAAK,wBAAwB,GAAG,6BAA6B;AAAA,gBAC3D,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,YAAY;AAAA,kBAC7C,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,cACD,KAAK,wBAAwB,GAAG,gCAAgC;AAAA,gBAC9D,MAAM;AAAA,gBACN,QAAQ;AAAA,kBACN,MAAM,iBAAK,sBAAsB,eAAe;AAAA,kBAChD,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,MAAM;AAAA,kBACN,OAAO;AAAA,kBACP,KAAK;AAAA,gBACP;AAAA,gBACA,QAAQ,CAAC;AAAA,cACX,CAAC;AAAA,YACH,CAAC;AAED,iBAAK,qBAAqB,IAAI,GAAG,KAAK,aAAa,yBAAyB;AAAA,UAC9E;AAEA,gBAAM,UAAU,CAAC,GAAG,QAAQ,QAAQ,OAAO,CAAC;AAC5C,gBAAM,OAA+B;AAAA,YACnC,IAAI,QAAQ;AAAA,YACZ,MAAM,QAAQ;AAAA,YACd,MAAM,QAAQ;AAAA,YACd,aAAa,QAAQ;AAAA,YACrB,SAAS,QAAQ,IAAI,CAAC,MAAO;AAAA,cAC3B,IAAI,EAAE,KAAK;AAAA,cACX,KAAK,EAAE,KAAK;AAAA,cACZ,aAAa,EAAE;AAAA,YACjB,EAAE;AAAA,UACJ;AACA,gBAAM,QAAwB,CAAC;AAC/B,cAAI,CAAC,wCAAkB,MAAM,KAAK,eAAe,IAAI,GAAG,KAAK,aAAa,sBAAsB,CAAC,GAAG;AAClG,kBAAM,KAAK,KAAK,cAAc,GAAG,wBAAwB,KAAK,UAAU,IAAI,GAAG,IAAI,CAAC;AACpF,iBAAK,eAAe,IAAI,GAAG,KAAK,aAAa,wBAAwB,IAAI;AAAA,UAC3E;AACA,gBAAM,QAAQ,IAAI;AAAA,YAChB,KAAK,cAAc,GAAG,+BAA+B,QAAQ,QAAQ,IAAI;AAAA,YACzE,KAAK,cAAc,GAAG,2BAA2B,QAAQ,IAAI,CAAC,MAAM,EAAE,WAAW,EAAE,KAAK,IAAI,GAAG,IAAI;AAAA,YACnG,GAAG;AAAA,UACL,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAKA,eAAW,CAAC,EAAE,EAAC,MAAM,eAAc,iBAAiB;AAClD,WAAK,IAAI,MAAM,eAAe,KAAK,UAAU,KAAK,IAAI;AAEtD,YAAM,KAAK,wBAAwB,SAAS,KAAK,MAAM;AAAA,QACrD,MAAM;AAAA,QACN,QAAQ;AAAA,UACN,MAAM,KAAK;AAAA,QACb;AAAA,QACA,QAAQ;AAAA,UACN,QAAQ,KAAK;AAAA,QACf;AAAA,MACF,CAAC;AAED,YAAM,QAAQ,IAAI;AAAA,QAChB,KAAK,wBAAwB,SAAS,KAAK,WAAW;AAAA,UACpD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,WAAW;AAAA,YAC5C,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QAED,KAAK,wBAAwB,SAAS,KAAK,UAAU;AAAA,UACnD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,UAAU;AAAA,YAC3C,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QAED,KAAK,wBAAwB,SAAS,KAAK,cAAc;AAAA,UACvD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,cAAc;AAAA,YAC/C,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,gBAAgB;AAAA,UACzD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,iBAAiB;AAAA,YAClD,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,uBAAuB;AAAA,UAChE,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,wBAAwB;AAAA,YACzD,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,kBAAkB;AAAA,UAC3D,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,wBAAwB;AAAA,YACzD,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QAED,KAAK,wBAAwB,SAAS,KAAK,WAAW;AAAA,UACpD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,cAAc;AAAA,YAC/C,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,eAAe;AAAA,UACxD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,WAAW;AAAA,YAC5C,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,gBAAgB;AAAA,UACzD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,YAAY;AAAA,YAC7C,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,mBAAmB;AAAA,UAC5D,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,eAAe;AAAA,YAChD,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QAED,KAAK,wBAAwB,SAAS,KAAK,gBAAgB;AAAA,UACzD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,QAAQ;AAAA,YACzC,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QAED,KAAK,wBAAwB,SAAS,KAAK,UAAU;AAAA,UACnD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,KAAK;AAAA,YACtC,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QAED,KAAK,wBAAwB,SAAS,KAAK,aAAa;AAAA,UACtD,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,QAAQ;AAAA,YACzC,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,mBAAmB;AAAA,UAC5D,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,eAAe;AAAA,YAChD,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,QACD,KAAK,wBAAwB,SAAS,KAAK,mBAAmB;AAAA,UAC5D,MAAM;AAAA,UACN,QAAQ;AAAA,YACN,MAAM,iBAAK,sBAAsB,eAAe;AAAA,YAChD,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN,OAAO;AAAA,YACP,KAAK;AAAA,UACP;AAAA,UACA,QAAQ,CAAC;AAAA,QACX,CAAC;AAAA,MACH,CAAC;AAED,WAAK,qBAAqB,IAAI,GAAG,KAAK,mBAAmB,KAAK,YAAY;AAE1E,WAAK,WAAW,IAAI,KAAK,EAAE;AAE3B,YAAM,KAAK,MAAM,KAAK,mBAAmB,KAAK,IAAI,UAAU,IAAI;AAEhE,YAAM,QAAwB,CAAC;AAC/B,YAAM,OAAqB;AAAA,QACzB,IAAI,KAAK;AAAA,QACT,KAAK,KAAK;AAAA,QACV,cAAc,GAAG;AAAA,QACjB,cAAc,GAAG;AAAA,QACjB,WAAW,KAAK,iBAAiB;AAAA,QACjC,KAAK,KAAK;AAAA,QACV,QAAQ,GAAG;AAAA,MACb;AACA,UAAI,CAAC,wCAAkB,MAAM,KAAK,eAAe,IAAI,GAAG,KAAK,mBAAmB,KAAK,SAAS,CAAC,GAAG;AAChG,cAAM,KAAK,KAAK,cAAc,SAAS,KAAK,WAAW,KAAK,UAAU,IAAI,GAAG,IAAI,CAAC;AAClF,aAAK,eAAe,IAAI,GAAG,KAAK,mBAAmB,KAAK,WAAW,IAAI;AAAA,MACzE;AACA,YAAM,QAAQ,IAAI;AAAA,QAChB,KAAK,cAAc,SAAS,KAAK,UAAU,KAAK,KAAK,IAAI;AAAA,QACzD,KAAK,cAAc,SAAS,KAAK,gBAAgB,KAAK,WAAW,IAAI;AAAA,QACrE,KAAK,cAAc,SAAS,KAAK,UAAU,KAAK,KAAK,IAAI;AAAA,QACzD,GAAG;AAAA,QACH,KAAK,mBAAmB,KAAK,IAAI,QAAQ;AAAA,MAC3C,CAAC;AAAA,IAEH;AAKA,UAAM,iBAAiB,MAAM,KAAK,mBAAmB;AAAA,MACnD,UAAU,GAAG,KAAK;AAAA,MAClB,QAAQ,GAAG,KAAK;AAAA,IAClB,CAAC;AACD,UAAM,oBAAoB,IAAI,OAAO,IAAI,KAAK,UAAU,KAAK,2DAA2D;AACxH,eAAW,QAAQ,eAAe,MAAM;AACtC,YAAM,IAAI,KAAK,GAAG,MAAM,iBAAiB;AACzC,UAAI,GAAG;AACL,cAAM,SAAS,EAAE;AACjB,YAAI,CAAC,2BAA2B,IAAI,KAAK,EAAE,GAAG;AAC5C,eAAK,IAAI,MAAM,kBAAkB,WAAW,KAAK,MAAM,OAAO,iDAAiD;AAC/G,eAAK,qBAAqB,OAAO,GAAG,KAAK,qBAAqB,gBAAgB;AAC9E,eAAK,eAAe,OAAO,GAAG,KAAK,qBAAqB,aAAa;AACrE,gBAAM,KAAK,qBAAqB,WAAW,UAAU,EAAE,WAAW,KAAK,CAAC;AAAA,QAC1E;AAAA,MACF;AAAA,IACF;AAKA,UAAM,eAAe,MAAM,KAAK,mBAAmB;AAAA,MACjD,UAAU,GAAG,KAAK;AAAA,MAClB,QAAQ,GAAG,KAAK;AAAA,IAClB,CAAC;AACD,UAAM,UAAU,IAAI,OAAO,IAAI,KAAK,UAAU,KAAK,4BAA4B;AAC/E,eAAW,QAAQ,aAAa,MAAM;AACpC,YAAM,IAAI,KAAK,GAAG,MAAM,OAAO;AAC/B,UAAI,GAAG;AACL,cAAM,SAAS,EAAE;AACjB,YAAI,CAAC,gBAAgB,IAAI,MAAM,GAAG;AAChC,eAAK,IAAI,MAAM,QAAQ,WAAW,KAAK,MAAM,OAAO,iDAAiD;AACrG,eAAK,WAAW,OAAO,MAAM;AAC7B,eAAK,qBAAqB,OAAO,GAAG,KAAK,mBAAmB,gBAAgB;AAC5E,eAAK,eAAe,OAAO,GAAG,KAAK,mBAAmB,aAAa;AACnE,gBAAM,KAAK,qBAAqB,SAAS,UAAU,EAAE,WAAW,KAAK,CAAC;AAAA,QACxE;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,QAQc,mBAAoB,QAAmB,UAA2B,sBAA+B,OAA0C;AA5rC3J;AA6rCI,QAAI,CAAC,KAAK,OAAO,qBAAqB;AACpC,aAAO,EAAE,cAAc,IAAI,cAAc,IAAI,QAAQ,GAAG;AAAA,IAC1D;AAEA,QAAI,CAAC,KAAK,WAAW,IAAI,MAAM,GAAG;AAChC,WAAK,IAAI,MAAM,+CAA+C,QAAQ;AACtE,aAAO,EAAE,cAAc,IAAI,cAAc,IAAI,QAAQ,GAAG;AAAA,IAC1D;AAEA,QAAI;AACF,YAAM,IAA8B;AAAA,QAClC,QAAQ,sCAAU,WAAU;AAAA,QAC5B,cAAe,6CAAU,WAAW,OAArB,mBAAyB,UAAS,WAAW,2CAAU,WAAW,OAArB,mBAAyB,QAAQ,2CAAU,WAAW,OAArB,mBAAyB,SAAS;AAAA,QAC/H,cAAc,4CAAU,WAAW,OAArB,mBAAyB,SAAQ;AAAA,MACjD;AACA,YAAM,QAAwB,CAAC;AAC/B,UAAI,CAAC,qBAAqB;AACxB,cAAM,OAAO,KAAK,eAAe,IAAI,GAAG,KAAK,mBAAmB,aAAa;AAC7E,YAAI,MAAM;AACR,eAAK,SAAS,EAAE;AAChB,eAAK,eAAe,EAAE;AACtB,eAAK,eAAe,EAAE;AACtB,eAAK,eAAe,IAAI,GAAG,KAAK,mBAAmB,eAAe,IAAI;AACtE,gBAAM,KAAK,KAAK,cAAc,SAAS,eAAe,KAAK,UAAU,IAAI,GAAG,IAAI,CAAC;AAAA,QACnF;AAAA,MACF;AACA,YAAM,QAAQ,IAAI;AAAA,QAChB,KAAK,cAAc,SAAS,iBAAiB,EAAE,QAAS,IAAI;AAAA,QAC5D,KAAK,cAAc,SAAS,uBAAuB,EAAE,cAAc,IAAI;AAAA,QACvE,KAAK,cAAc,SAAS,uBAAuB,EAAE,cAAc,IAAI;AAAA,QACvE,GAAG;AAAA,MACL,CAAC;AACD,aAAO;AAAA,IACT,SAAS,KAAP;AACA,WAAK,IAAI,KAAK,8CAA8C,WAAW,KAAK;AAC5E,aAAO,EAAE,cAAc,IAAI,cAAc,IAAI,QAAQ,GAAG;AAAA,IAC1D;AAAA,EACF;AAAA,QAKc,eAAgB,MAA6C;AAvuC7E;AAwuCI,QAAI,CAAC,YAAK,WAAL,mBAAa;AAAM;AAExB,QAAI,CAAC,MAAM;AACT,aAAO,CAAC;AAAA,IACV;AAEA,QAAI,CAAC,KAAK,QAAQ;AAChB,WAAK,SAAW,aAAM,KAAK,cAAc,YAAY,MAArC,mBAAyC,QAA0C;AAAA,IACrG;AACA,QAAI,CAAC,8CAA2B,SAAS,KAAK,MAAM,GAAG;AACrD,WAAK,SAAS;AAAA,IAChB;AAEA,UAAM,eAA6B;AAAA,MACjC,QAAQ,KAAK;AAAA,MACb,YAAY,CAAC;AAAA,IACf;AAEA,QAAI,KAAK,iBAAiB,QAAW;AACnC,WAAK,eAAiB,aAAM,KAAK,cAAc,kBAAkB,MAA3C,mBAA+C,QAAyC;AAAA,IAChH;AACA,QAAI,CAAC,wCAAqB,SAAS,KAAK,YAAY,GAAG;AACrD,WAAK,eAAe;AAAA,IACtB;AACA,QAAI,KAAK,iBAAiB,QAAW;AACnC,WAAK,eAAiB,aAAM,KAAK,cAAc,kBAAkB,MAA3C,mBAA+C,QAA8B;AAAA,IACrG;AACA,QAAI,KAAK,gBAAgB,KAAK,cAAc;AAC1C,mBAAa,aAAa,CAAC;AAAA,QACzB,MAAM,KAAK;AAAA,QACX,MAAM,KAAK;AAAA,MACb,CAAC;AAAA,IACH;AAEA,SAAK,IAAI,MAAM,qBAAqB,KAAK,UAAU,YAAY,GAAG;AAClE,SAAK,OAAO,KAAK,YAAY,YAAY;AAAA,EAC3C;AAAA,QAOc,sBAAuB,SAA0C;AAnxCjF;AAoxCI,SAAK,IAAI,MAAM,wBAAwB,QAAQ,UAAU,QAAQ,kBAAkB,QAAQ,OAAO,QAAQ,QAAQ,SAAS;AAG3H,QAAI,KAAK,OAAO,iBAAiB;AAE/B,WAAK,SAAS,mBAAmB,KAAK,UAAU,QAAQ,OAAO,GAAG,CAAC,MAAM,UAAU,OAAO,UAAU,WAAW,MAAM,SAAS,IAAI,KAAK,GAAG,IAAI;AAAA,IAChJ;AAEA,QAAI,CAAC,kBAAK,WAAL,mBAAa,SAAb,mBAAmB;AAAI;AAG5B,QAAI,QAAQ,aAAa;AACvB;AAAA,IACF;AAEA,UAAM,EAAE,QAAQ,SAAS,YAAY;AAGrC,QAAI,OAAO,OAAO,KAAK,OAAO,KAAK,IAAI;AACrC;AAAA,IACF;AAEA,UAAM,kBAAkB,QAAQ,UAAU;AAE1C,UAAM,qBAAqB,KAAK,uBAAuB,eAAe;AAEtE,QAAI,CAAC,KAAK,OAAO,wCAAwC,CAAC,oBAAoB;AAC5E,WAAK,IAAI,MAAM,yCAAyC,OAAO,WAAW,OAAO,KAAK;AACtF;AAAA,IACF;AAEA,UAAM,YAAY,QAAQ,SAAS,MAAM,IAAI,KAAK,OAAO,KAAK,EAAE;AAEhE,QAAI,aAAa,KAAK,OAAO,mBAAmB,oBAAoB;AAClE,UAAI;AACF,cAAM,QAAQ,MAAM,KAAK,OAAO,oBAAoB;AAAA,MACtD,SAAS,KAAP;AACA,aAAK,IAAI,KAAK,0CAA0C,QAAQ,OAAO,KAAK;AAAA,MAC9E;AAAA,IACF;AAEA,QAAI,CAAC,aAAa,QAAQ,SAAS,gBAAgB,CAAC,KAAK,OAAO,mCAAmC;AACjG,WAAK,IAAI,MAAM,gDAAgD;AAC/D;AAAA,IACF;AAEA,QAAI;AACJ,QAAI,QAAQ,SAAS,cAAc;AACjC,yBAAmB,QAAQ,WAAW,GAAG,KAAK,qBAAqB,QAAQ,oBAAoB,QAAQ,qBAAqB,QAAQ,OAAO,GAAG,KAAK,qBAAqB,QAAQ,oBAAoB,QAAQ;AAAA,IAC9M,WAAW,QAAQ,SAAS,MAAM;AAChC,yBAAmB,GAAG,KAAK,mBAAmB,OAAO;AAAA,IACvD,OAAO;AACL,WAAK,IAAI,KAAK,8BAA8B;AAC5C;AAAA,IACF;AAGA,QAAI,CAAC,KAAK,qBAAqB,IAAI,GAAG,0BAA0B,GAAG;AACjE,WAAK,IAAI,MAAM,8BAA8B,sDAAsD;AACnG;AAAA,IACF;AAGA,UAAM,OAAuB;AAAA,MAC3B;AAAA,MACA,aAAa,QAAQ,YAAY,IAAI,CAAC,QAAS,GAAE,YAAY,IAAI,WAAW,SAAS,GAAG,MAAM,IAAI,MAAM,MAAM,IAAI,MAAM,IAAI,IAAI,GAAG,EAAE;AAAA,MACrI,IAAI,QAAQ;AAAA,MACZ,UAAU,eAAQ,SAAS,YAAjB,mBAA0B,IAAI,CAAC,MAAO,GAAE,IAAI,EAAE,IAAI,KAAK,EAAE,KAAK,KAAK,aAAa,EAAE,YAAY,QAAO,CAAC;AAAA,MAChH;AAAA,MACA,WAAW,QAAQ;AAAA,MACnB,YAAY;AAAA,IACd;AACA,UAAM,QAAwB,CAAC;AAC/B,QAAI,QAAQ,SAAS;AACnB,WAAK,SAAS;AAAA,QACZ,IAAI,OAAO;AAAA,QACX,KAAK,OAAO;AAAA,QACZ,aAAa,kBAAK,OAAO,OAAO,MAAM,IAAI,QAAQ,OAAO,MAA5C,mBAA+C,QAAQ,MAAM,IAAI,OAAO,QAAxE,mBAA6E,gBAAe,OAAO;AAAA,MAClH;AACA,YAAM,KAAK,KAAK,cAAc,GAAG,kCAAkC,OAAO,KAAK,IAAI,CAAC;AAAA,IACtF;AACA,QAAI,CAAC,wCAAkB,MAAM,KAAK,eAAe,IAAI,GAAG,KAAK,aAAa,8BAA8B,CAAC,GAAG;AAC1G,YAAM,KAAK,KAAK,cAAc,GAAG,gCAAgC,KAAK,UAAU,IAAI,GAAG,IAAI,CAAC;AAC5F,WAAK,eAAe,IAAI,GAAG,KAAK,aAAa,gCAAgC,IAAI;AAAA,IACnF;AACA,UAAM,QAAQ,IAAI;AAAA,MAChB,KAAK,cAAc,GAAG,4BAA4B,SAAS,IAAI;AAAA,MAC/D,KAAK,cAAc,GAAG,8BAA8B,QAAQ,IAAI,IAAI;AAAA,MACpE,KAAK,cAAc,GAAG,qCAAqC,QAAQ,kBAAkB,IAAI;AAAA,MACzF,GAAG;AAAA,IACL,CAAC;AAGD,QAAI,WAAW,KAAK,OAAO,wBAAwB,KAAK,oBAAoB,IAAI,GAAG,0BAA0B,GAAG;AAE9G,UAAI,KAAK,uBAAuB,iBAAiB,EAAE,iBAAiB,KAAK,CAAC,GAAG;AAE3E,aAAK,IAAI,MAAM,YAAY,eAAe,KAAK,OAAO,sBAAsB;AAE5E,cAAM,UAAsC;AAAA,UAC1C,MAAM;AAAA,QACR;AAEA,aAAK,OAAO,KAAK,OAAO,sBAAsB,QAAQ,SAAS,OAAO,gBAAgB;AAEpF,gBAAM,WAAgC,2CAAmE;AACzG,cAAI;AACF,gBAAI,CAAC,UAAU;AACb,mBAAK,IAAI,MAAM,uBAAuB,KAAK,OAAO,sBAAsB;AACxE;AAAA,YACF;AACA,iBAAK,IAAI,MAAM,iBAAiB,KAAK,OAAO,yBAAyB,UAAU;AAC/E,oBAAQ,KAAK,OAAO;AAAA,mBACb;AACH,sBAAM,QAAQ,MAAM,QAAQ;AAC5B;AAAA,mBACG;AACH,sBAAM,QAAQ,QAAQ,KAAK,QAAQ;AACnC;AAAA;AAAA;AAAA,UAIN,SAAS,KAAP;AACA,iBAAK,IAAI,KAAK,oCAAoC,kBAAkB,KAAK,OAAO,yBAAyB,KAAK;AAAA,UAChH;AAAA,QACF,CAAC;AAAA,MACH,OAAO;AAEL,aAAK,IAAI,MAAM,QAAQ,OAAO,WAAW,OAAO,qCAAqC;AAAA,MACvF;AAAA,IACF;AAAA,EAEF;AAAA,QAMc,yBAA0B,UAAsB,UAAqC;AA95CrG;AA+5CI,QAAI,CAAC,gBAAS,WAAT,mBAAiB,KAAI;AACxB;AAAA,IACF;AAEA,QAAI,CAAC,KAAK,WAAW,IAAI,SAAS,OAAO,EAAE,GAAG;AAC5C,WAAK,IAAI,MAAM,kDAAkD,SAAS,OAAO,IAAI;AACrF;AAAA,IACF;AAEA,UAAM,QAAwB,CAAC;AAC/B,UAAM,OAA8B,mBAC/B,KAAK,eAAe,IAAI,GAAG,KAAK,qBAAqB,SAAS,MAAM,cAAc,SAAS,OAAO,SAAS;AAGhH,QAAI,SAAkB;AAEtB,QAAI,SAAS,cAAc,SAAS,WAAW;AAC7C,YAAM,KAAK,KAAK,cAAc,WAAW,SAAS,MAAM,cAAc,SAAS,OAAO,mBAAmB,gBAAS,YAAT,mBAAkB,SAAQ,IAAI,IAAI,CAAC;AAC5I,WAAK,eAAe,gBAAS,YAAT,mBAAkB,SAAQ;AAC9C,eAAS;AAAA,IACX;AACA,QAAI,SAAS,eAAe,SAAS,YAAY;AAC/C,YAAM,KAAK,KAAK,cAAc,WAAW,SAAS,MAAM,cAAc,SAAS,OAAO,sBAAsB,CAAC,CAAC,SAAS,YAAY,IAAI,CAAC;AACxI,WAAK,gBAAgB,CAAC,CAAC,SAAS;AAChC,eAAS;AAAA,IACX;AACA,QAAI,SAAS,aAAa,SAAS,UAAU;AAC3C,YAAM,KAAK,KAAK,cAAc,WAAW,SAAS,MAAM,cAAc,SAAS,OAAO,oBAAoB,CAAC,CAAC,SAAS,UAAU,IAAI,CAAC;AACpI,WAAK,kBAAkB,CAAC,CAAC,SAAS;AAClC,eAAS;AAAA,IACX;AACA,QAAI,SAAS,eAAe,SAAS,YAAY;AAC/C,YAAM,KAAK,KAAK,cAAc,WAAW,SAAS,MAAM,cAAc,SAAS,OAAO,sBAAsB,CAAC,CAAC,SAAS,YAAY,IAAI,CAAC;AACxI,WAAK,gBAAgB,CAAC,CAAC,SAAS;AAChC,eAAS;AAAA,IACX;AACA,QAAI,SAAS,aAAa,SAAS,UAAU;AAC3C,YAAM,KAAK,KAAK,cAAc,WAAW,SAAS,MAAM,cAAc,SAAS,OAAO,oBAAoB,CAAC,CAAC,SAAS,UAAU,IAAI,CAAC;AACpI,WAAK,kBAAkB,CAAC,CAAC,SAAS;AAClC,eAAS;AAAA,IACX;AAGA,QAAI,QAAQ;AACV,YAAM,KAAK,KAAK,cAAc,WAAW,SAAS,MAAM,cAAc,SAAS,OAAO,WAAW,KAAK,UAAU,IAAI,GAAG,IAAI,CAAC;AAC5H,WAAK,eAAe,IAAI,GAAG,KAAK,qBAAqB,SAAS,MAAM,cAAc,SAAS,OAAO,WAAW,IAAI;AAAA,IACnH;AAEA,UAAM,QAAQ,IAAI,KAAK;AAAA,EACzB;AAAA,QAQc,eAAgB,OAAe,WAAqD,WAAiD;AAEjJ,QAAI,MAAM,WAAW,GAAG,KAAK,YAAY,KAAK,MAAM,SAAS,UAAU,GAAG;AACxE,UAAI,wCAAW,YAAW,UAAU,oBAAoB;AACtD,aAAK,IAAI,MAAM,0CAA0C,OAAO;AAChE,aAAK,oBAAoB,IAAI,KAAK;AAAA,MACpC,WAAW,KAAK,oBAAoB,IAAI,KAAK,GAAG;AAC9C,aAAK,IAAI,MAAM,2CAA2C,OAAO;AACjE,aAAK,oBAAoB,OAAO,KAAK;AAAA,MACvC;AAAA,IACF;AAEA,QAAI,uCAAW,gBAAgB;AAI7B,UAAI,CAAC,WAAW;AACd,cAAM,MAAM,MAAM,KAAK,sBAAsB,KAAK;AAClD,YAAI,4BAAK,UAAS,SAAS;AACzB,sBAAY,IAAI;AAAA,QAClB,OAAO;AACL,eAAK,IAAI,KAAK,UAAU,4FAA4F;AAAA,QACtH;AAAA,MACF;AAGA,UAAI,OAAO,UAAU;AACrB,UAAI,CAAC,QAAQ,WAAW;AACtB,YAAI,OAAO,UAAU,SAAS,UAAU;AACtC,iBAAO,UAAU,KAAK,iBAAK,aAAa,UAAU,KAAK;AAAA,QACzD,OAAO;AACL,iBAAO,UAAU;AAAA,QACnB;AAAA,MACF;AAEA,YAAM,MAA2B;AAAA,QAC/B,IAAI;AAAA,QACJ,OAAO,UAAU,iBAAiB;AAAA,QAClC,MAAM,QAAQ;AAAA,QACd,KAAK,CAAC,CAAC,UAAU;AAAA,QACjB,KAAK,CAAC,CAAC,UAAU;AAAA,MACnB;AAGA,UAAI,QAAiB;AACrB,UAAI,IAAI,KAAK,SAAS,KAAK;AACzB,aAAK,IAAI,KAAK,oBAAoB,oEAAoE;AACtG,gBAAQ;AAAA,MACV;AACA,UAAI,CAAC,IAAI,MAAM,MAAM,yBAAyB,GAAG;AAC/C,aAAK,IAAI,KAAK,qBAAqB,8FAA8F;AACjI,gBAAQ;AAAA,MACV;AAGA,WAAK,qBAAqB,mBAAmB,OAAO,QAAQ,MAAM,IAAI;AAAA,IAExE,OAAO;AAEL,WAAK,qBAAqB,mBAAmB,OAAO,IAAI;AAAA,IAC1D;AAAA,EACF;AAAA,EAMQ,eAAgB,OAAe,KAA+C;AA3hDxF;AA4hDI,QAAI,KAAK;AAEP,UAAI,IAAI,SAAS,SAAS;AACxB,aAAK,IAAI,MAAM,UAAU,kBAAkB,KAAK,UAAU,GAAG,GAAG;AAChE,aAAK,eAAe,OAAO,gBAAI,WAAJ,mBAAY,WAAZ,mBAAqB,KAAK,YAAY,IAAI,MAAM;AAAA,MAC7E;AAAA,IACF,OAAO;AAEL,WAAK,IAAI,MAAM,UAAU,eAAe;AACxC,WAAK,eAAe,OAAO,IAAI;AAAA,IACjC;AAAA,EACF;AAAA,QAMc,cAAc,SAAiB,OAAyD;AACpG,SAAK,IAAI,MAAM,kBAAkB,WAAW,+BAAO,YAAY,+BAAO,MAAM;AAE5E,QAAI,CAAC,SAAS,MAAM;AAAK;AAEzB,QAAI,SAAS;AAKb,QAAI,QAAQ,WAAW,GAAG,KAAK,YAAY,GAAG;AAE5C,cAAQ;AAAA,aACD,GAAG,KAAK;AACX,gBAAM,KAAK,eAAe,EAAE,QAAQ,MAAM,IAA0B,CAAC;AACrE,mBAAS;AACT;AAAA,aACG,GAAG,KAAK;AACX,gBAAM,KAAK,eAAe,EAAE,cAAc,MAAM,IAAyB,CAAC;AAC1E,mBAAS;AACT;AAAA,aACG,GAAG,KAAK;AACX,gBAAM,KAAK,eAAe,EAAE,cAAc,MAAM,IAAc,CAAC;AAC/D,mBAAS;AACT;AAAA;AAIA,cAAI,QAAQ,MAAM,6CAA6C,GAAG;AAChE,qBAAS,MAAM,KAAK,oCAAoC,SAAS,KAAK;AAAA,UAGxE,WAAW,QAAQ,SAAS,OAAO,KAAK,QAAQ,SAAS,WAAW,KAAK,QAAQ,SAAS,YAAY,KAAK,QAAQ,SAAS,eAAe,GAAG;AAC5I,qBAAS,MAAM,KAAK,kBAAkB,SAAS,KAAK;AAAA,UAGtD,WAAW,QAAQ,SAAS,kBAAkB,KAAK,QAAQ,SAAS,kBAAkB,KAAK,QAAQ,SAAS,kBAAkB,GAAG;AAC/H,qBAAS,MAAM,KAAK,mBAAmB,SAAS,KAAK;AAAA,UAEvD;AAAA;AAAA,IAGN;AAEA,QAAI,QAAQ;AACV,YAAM,KAAK,cAAc,SAAS,iCAC7B,QAD6B;AAAA,QAEhC,KAAK;AAAA,MACP,EAAC;AAAA,IACH;AAAA,EAEF;AAAA,QAOc,kBAAmB,SAAiB,OAAyC;AAvmD7F;AAymDI,QAAI,CAAC,YAAK,WAAL,mBAAa,YAAW;AAC3B,WAAK,IAAI,KAAK,SAAS,0CAA0C;AACjE,aAAO;AAAA,IACT;AAEA,QAAI,OAAO,MAAM,QAAQ,UAAU;AACjC,WAAK,IAAI,KAAK,SAAS,4CAA4C;AACnE,aAAO;AAAA,IACT;AAEA,QAAI,MAAM,IAAI,WAAW,GAAG;AAC1B,WAAK,IAAI,MAAM,SAAS,oCAAoC;AAC5D,aAAO;AAAA,IACT;AAEA,QAAI;AACJ,QAAI;AACJ,QAAI,aAAqB;AACzB,QAAI;AAGJ,QAAI,IAAI,QAAQ,MAAM,+GAA+G;AACrI,QAAI,GAAG;AACL,YAAM,UAAU,EAAE;AAClB,YAAM,YAAY,EAAE,MAAM,EAAE;AAC5B,0BAAoB,EAAE;AACtB,eAAS,EAAE;AAEX,YAAM,UAAU,WAAK,OAAO,OAAO,MAAM,IAAI,OAAO,MAApC,mBAAuC,SAAS,MAAM,IAAI;AAC1E,UAAI,CAAC,oCAAS,aAAY,QAAQ,SAAS,GAAG;AAC5C,aAAK,IAAI,KAAK,SAAS,yDAAyD;AAChF,eAAO;AAAA,MACT;AAEA,eAAS;AACT,mBAAa,QAAQ,SAAS,GAAG,QAAQ,MAAM,QAAQ,QAAQ,OAAO,QAAQ,QAAQ,SAAS,GAAG,QAAQ,MAAM,QAAQ,QAAQ;AAAA,IAElI,OAAO;AACL,UAAI,QAAQ,MAAM,wEAAwE;AAC1F,UAAI,CAAC,GAAG;AACN,aAAK,IAAI,KAAK,SAAS,oEAAoE;AAC3F,eAAO;AAAA,MACT;AACA,YAAM,SAAS,EAAE;AACjB,0BAAoB,EAAE;AACtB,eAAS,EAAE;AAEX,YAAM,OAAO,KAAK,OAAO,MAAM,MAAM,IAAI,MAAM;AAC/C,UAAI,CAAC,MAAM;AACT,aAAK,IAAI,KAAK,SAAS,iDAAiD;AACxE,eAAO;AAAA,MACT;AAEA,eAAS;AACT,mBAAa,KAAK;AAAA,IACpB;AAEA,QAAI;AAKJ,QAAI,WAAW,YAAY;AACzB,YAAM,MAAM,MAAM,IAAI,QAAQ,GAAG;AACjC,UAAI;AACJ,UAAI,UAA8B;AAClC,UAAI,MAAM,GAAG;AACX,eAAO,MAAM,IAAI,MAAM,GAAG,GAAG;AAC7B,kBAAU,MAAM,IAAI,MAAM,MAAM,CAAC;AAAA,MACnC,OAAO;AACL,eAAO,MAAM;AAAA,MACf;AAGA,YAAM,UAAU,mDAAiC,IAAI;AACrD,UAAI,SAAS;AAEX,aAAK;AAAA,UACH;AAAA,UACA,OAAO,CAAC;AAAA,YACN,YAAY,QAAQ;AAAA,YACpB,MAAM,QAAQ;AAAA,UAChB,CAAC;AAAA,QACH;AAAA,MAEF,OAAO;AAEL,cAAM,OAAO,+CAA6B,IAAI;AAG9C,YAAI,KAAK,WAAW,SAAS,GAAG;AAC9B,iBAAO,KAAK,MAAM,CAAC;AAAA,QACrB;AAEA,aAAK;AAAA,UACH;AAAA,UACA,OAAO,CAAC;AAAA,YACN,YAAY;AAAA,YACZ;AAAA,UACF,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IAMF,WAAW,WAAW,eAAe,WAAW,gBAAgB;AAC9D,YAAM,MAAM,MAAM,IAAI,QAAQ,GAAG;AACjC,UAAI;AACJ,UAAI;AACJ,UAAI,MAAM,GAAG;AACX,2BAAmB,MAAM,IAAI,MAAM,GAAG,GAAG;AACzC,kBAAU,MAAM,IAAI,MAAM,MAAM,CAAC;AAAA,MACnC,OAAO;AAEL,aAAK,IAAI,MAAM,8DAA8D,mBAAmB;AAChG,2BAAoB,YAAM,KAAK,qBAAqB,GAAG,6BAA6B,MAAhE,mBAAoE;AACxF,kBAAU,MAAM;AAAA,MAClB;AAEA,UAAI,WAAW,aAAa;AAE1B,YAAI,CAAC,oBAAoB,CAAC,SAAS;AACjC,eAAK,IAAI,KAAK,oDAAoD,UAAU;AAC5E,iBAAO;AAAA,QACT;AAEA,YAAI;AACF,eAAK,KAAK,+BAA+B,MAAM,GAAG;AAAA,QACpD,SAAS,KAAP;AACA,eAAK,IAAI,MAAM,SAAS,6BAA6B,KAAK;AAC1D,iBAAO;AAAA,QACT;AAGA,YAAI,CAAC,GAAG,OAAO;AACb,aAAG,QAAQ;AAAA,YACT;AAAA,UACF;AAAA,QACF,WAAW,CAAC,GAAG,MAAM,kBAAkB;AACrC,aAAG,MAAM,mBAAmB;AAAA,QAC9B;AAAA,MAEF,OAAO;AAEL,YAAI,CAAC,oBAAoB,CAAC,SAAS;AACjC,eAAK,IAAI,KAAK,+DAA+D,UAAU;AACvF,iBAAO;AAAA,QACT;AAEA,cAAM,UAAU,kBAAkB,sBAAO,OAAO,aAAa,MAAM,OAAO,SAAS,IAAI;AACvF,YAAI,CAAC,WAAW,CAAC,QAAQ,OAAO,GAAG;AACjC,eAAK,IAAI,KAAK,mDAAmD,UAAU;AAC3E,iBAAO;AAAA,QACT;AAGA,cAAM,UAAwC,QAAQ,SAAS,MAAM,IAAI,gBAAgB,KAAK,MAAM,QAAQ,SAAS,MAAM,gBAAgB;AAC3I,YAAI,CAAC,SAAS;AACZ,eAAK,IAAI,KAAK,mDAAmD,UAAU;AAC3E,iBAAO;AAAA,QACT;AAEA,YAAI;AACF,gBAAM,QAAQ,MAAM,OAAO;AAC3B,iBAAO;AAAA,QACT,SAAS,KAAP;AACA,eAAK,IAAI,KAAK,oBAAoB,mBAAmB,KAAK;AAC1D,iBAAO;AAAA,QACT;AAAA,MACF;AAAA,IAOF,OAAO;AACL,UAAI;AACF,aAAK,KAAK,+BAA+B,MAAM,GAAG;AAAA,MACpD,SAAS,KAAP;AACA,aAAK,IAAI,MAAM,SAAS,6BAA6B,KAAK;AAC1D,eAAO;AAAA,MACT;AAAA,IACF;AAEA,SAAK,IAAI,MAAM,WAAW,eAAe,KAAK,UAAU,EAAE,GAAG;AAC7D,QAAI;AACF,YAAM,MAAM,MAAM,OAAO,KAAK,EAAE;AAChC,WAAK,IAAI,MAAM,wBAAwB,IAAI,IAAI;AAC/C,aAAO;AAAA,IACT,SAAS,KAAP;AACA,WAAK,IAAI,KAAK,0BAA0B,cAAc,eAAe,KAAK;AAC1E,aAAO;AAAA,IACT;AAAA,EACF;AAAA,QAOc,oCAAqC,SAAiB,OAAyC;AApzD/G;AAszDI,QAAI,CAAC,YAAK,WAAL,mBAAa,YAAW;AAC3B,WAAK,IAAI,KAAK,SAAS,0CAA0C;AACjE,aAAO;AAAA,IACT;AAEA,QAAI,OAAO,MAAM,QAAQ,UAAU;AACjC,WAAK,IAAI,KAAK,SAAS,4CAA4C;AACnE,aAAO;AAAA,IACT;AAEA,QAAI,MAAM,IAAI,WAAW,GAAG;AAC1B,WAAK,IAAI,MAAM,SAAS,oCAAoC;AAC5D,aAAO;AAAA,IACT;AAEA,UAAM,oBAAoB,QAAQ,QAAQ,UAAU,EAAE;AAEtD,UAAM,MAAM,MAAM,IAAI,QAAQ,GAAG;AACjC,QAAI;AACJ,QAAI;AACJ,QAAI,MAAM,GAAG;AACX,sBAAgB,MAAM,IAAI,MAAM,GAAG,GAAG;AACtC,gBAAU,MAAM,IAAI,MAAM,MAAM,CAAC;AAAA,IACnC,OAAO;AAEL,WAAK,IAAI,MAAM,sEAAsE,mBAAmB;AACxG,sBAAiB,YAAM,KAAK,qBAAqB,GAAG,iCAAiC,MAApE,mBAAwE;AACzF,gBAAU,MAAM;AAAA,IAClB;AAEA,QAAI,CAAC,iBAAiB,CAAC,SAAS;AAC9B,WAAK,IAAI,KAAK,wDAAwD,UAAU;AAChF,aAAO;AAAA,IACT;AAEA,QAAI;AACF,YAAM,KAAK,qBAAqB,mBAAmB,eAAe,OAAO;AACzE,aAAO;AAAA,IACT,SAAS,KAAP;AACA,WAAK,IAAI,KAAK,uCAAuC,0CAA0C,KAAK;AACpG,aAAO;AAAA,IACT;AAAA,EACF;AAAA,QAMc,mBAAoB,SAAiB,OAAyC;AAt2D9F;AAu2DI,UAAM,IAAI,QAAQ,MAAM,yFAAyF;AACjH,QAAI,CAAC,GAAG;AACN,WAAK,IAAI,MAAM,eAAe,0DAA0D;AACxF,aAAO;AAAA,IACT;AACA,UAAM,CAAC,EAAE,SAAS,UAAU,UAAU;AAEtC,UAAM,QAAQ,WAAK,WAAL,mBAAa,OAAO,MAAM,IAAI;AAC5C,UAAM,SAAS,+BAAO,QAAQ,MAAM,IAAI;AACxC,QAAI,CAAC,SAAS,CAAC,QAAQ;AACrB,WAAK,IAAI,KAAK,eAAe,sDAAsD;AACnF,aAAO;AAAA,IACT;AAEA,QAAI;AACF,cAAQ;AAAA,aACD;AACH,cAAI,CAAC,MAAM,KAAK;AACd,mBAAO;AAAA,UACT;AACA,gBAAM,OAAO,MAAM,WAAW;AAC9B,eAAK,IAAI,MAAM,gBAAgB,OAAO,KAAK,iBAAiB,MAAM,oBAAoB;AACtF;AAAA,aAEG;AACH,gBAAM,OAAO,MAAM,QAAQ,CAAC,CAAC,MAAM,GAAG;AACtC,eAAK,IAAI,MAAM,iCAAiC,OAAO,KAAK,iBAAiB,MAAM,eAAe,CAAC,CAAC,MAAM,MAAM;AAChH;AAAA,aAEG;AACH,gBAAM,OAAO,MAAM,QAAQ,CAAC,CAAC,MAAM,GAAG;AACtC,eAAK,IAAI,MAAM,+BAA+B,OAAO,KAAK,iBAAiB,MAAM,eAAe,CAAC,CAAC,MAAM,MAAM;AAC9G;AAAA;AAIA,iBAAO;AAAA;AAEX,aAAO;AAAA,IACT,SAAS,KAAP;AACA,WAAK,IAAI,KAAK,iCAAiC,OAAO,KAAK,iBAAiB,MAAM,uBAAuB,KAAK;AAC9G,aAAO;AAAA,IACT;AAAA,EACF;AAAA,QAMc,UAAW,KAAsC;AAx5DjE;AAy5DI,QAAI,OAAO,QAAQ;AAAU;AAC7B,SAAK,IAAI,MAAM,gBAAgB,KAAK,UAAU,GAAG,GAAG;AAGpD,QAAI;AACJ,QAAI;AACJ,QAAI;AAEJ,YAAQ,IAAI;AAAA,WACL;AACH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AACA,cAAM,OAAO,MAAM,KAAK,mBAAmB,UAAU,YAAY;AAAA,UAC/D,UAAU;AAAA,UACV,QAAQ;AAAA,QACV,CAAC;AACD,cAAM,wBAAwB,KAAK,KAAK,IAAI,CAAC,MAAM;AACjD,gBAAM,KAAK,EAAE,GAAG,MAAM,EAAE;AACxB,iBAAO;AAAA,YACL,OAAO;AAAA,YACP,OAAO;AAAA,UACT;AAAA,QACF,CAAC;AACD,aAAK,IAAI,MAAM,iCAAiC,sBAAsB,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG;AAC3F,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS,CAAC,EAAC,OAAO,IAAI,OAAO,MAAK,GAAG,GAAG,qBAAqB,GAAG,IAAI,QAAQ;AACtG;AAAA,WAEG;AACH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,cAAM,QAAQ,YAAK,WAAL,mBAAa,MAAM,MAAM,IAAI,CAAC,MAAO,GAAE,OAAO,EAAE,KAAK,OAAO,EAAE,GAAG,QAAO,CAAC;AACvF,aAAK,IAAI,MAAM,UAAU,MAAM,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG;AACpD,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS,OAAO,IAAI,QAAQ;AACtD;AAAA,WAEG;AACH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,cAAM,UAAU,YAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,CAAC,MAAO,GAAE,OAAO,EAAE,MAAM,OAAO,EAAE,GAAG,QAAO,CAAC;AAC3F,aAAK,IAAI,MAAM,YAAY,QAAQ,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG;AACxD,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS,SAAS,IAAI,QAAQ;AACxD;AAAA,WAEG;AACH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,CAAC,KAAK,QAAQ;AAChB,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,CAAC,GAAG,IAAI,QAAQ;AACnD;AAAA,QACF;AAEA,cAAM,sBAAsB,CAAC;AAC7B,mBAAW,CAAC,EAAE,UAAU,KAAK,OAAO,OAAO,OAAO;AAChD,qBAAW,CAAC,EAAE,SAAS,MAAM,MAAM,OAAO;AACxC,gCAAoB,KAAK;AAAA,cACvB,OAAO,GAAG,MAAM,UAAU,KAAK;AAAA,cAC/B,OAAO,GAAG,MAAM,MAAM,KAAK;AAAA,YAC7B,CAAC;AAAA,UACH;AAAA,QACF;AAEA,aAAK,IAAI,MAAM,iBAAiB,oBAAoB,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG;AACzE,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS,qBAAqB,IAAI,QAAQ;AAEpE;AAAA,WAEG;AACH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AACA,YAAI,iBAAK,WAAL,mBAAa,SAAb,mBAAmB,IAAI;AACzB,gBAAM,QAAQ,IAAI,2BAAY;AAAA,YAC5B,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,YAClB,2BAAY,MAAM;AAAA,UACpB,CAAC;AACD,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,sDAAsD,KAAK,OAAO,KAAK,kBAAkB,MAAM,8CAA8C,IAAI,QAAQ;AAAA,QAC9L,OAAO;AACL,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,KAAK,iBAAK,UAAU,6CAA6C,OAAO,IAAI,QAAQ;AAAA,QACzH;AACA;AAAA,WAEG;AACH,aAAK,qBAAqB,4BAA4B;AACtD,YAAI,IAAI,UAAU;AAChB,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,QAAQ,KAAK,GAAG,IAAI,QAAQ;AAAA,QACnE;AACA;AAAA,WAEG;AAAA,WACA;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,cAAc,IAAI;AAGxB,YAAI,CAAC,YAAY,WAAY,OAAO,YAAY,YAAY,YAAY,OAAO,YAAY,YAAY,UAAW;AAChH,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,6DAA8D,cAAe,IAAI,QAAQ;AACrI;AAAA,QACF;AAEA,YAAI,YAAY,UAAU,YAAY,SAAS;AAE7C,cAAI,YAAY,QAAQ;AAEtB,mBAAO,WAAK,WAAL,mBAAa,MAAM,MAAM,IAAI,YAAY;AAChD,gBAAI,CAAC,MAAM;AACT,mBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,uBAAuB,YAAY,kBAAmB,cAAe,IAAI,QAAQ;AAC7H;AAAA,YACF;AAAA,UACF,OAAO;AAEL,mBAAO,WAAK,WAAL,mBAAa,MAAM,MAAM,KAAK,CAAC,MAAM,EAAE,QAAQ,YAAY;AAClE,gBAAI,CAAC,MAAM;AACT,mBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,wBAAwB,YAAY,mBAAoB,cAAe,IAAI,QAAQ;AAC/H;AAAA,YACF;AAAA,UACF;AACA,cAAI;AACF,kBAAM,MAAM,KAAK,KAAK,YAAY,OAAO;AACzC,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,+BAAE,QAAQ,wBAAwB,KAAK,SAAU,cAAjD,EAA8D,WAAW,IAAI,GAAG,IAAG,IAAI,QAAQ;AAAA,UACpI,SAAS,KAAP;AACA,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,iCAAiC,KAAK,QAAQ,SAAU,cAAe,IAAI,QAAQ;AAAA,UACjI;AAAA,QAEF,WAAW,YAAY,YAAY,YAAY,WAAW;AAExD,oBAAU,iBAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,YAAY,cAA1C,mBAAqD,SAAS,MAAM,IAAI,YAAY;AAC9F,cAAI,CAAC,oCAAS,WAAU;AACtB,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,kCAAkC,YAAY,uBAAuB,YAAY,oBAAqB,cAAe,IAAI,QAAQ;AAC7K;AAAA,UACF;AACA,cAAI;AACF,kBAAM,MAAM,QAAQ,KAAK,YAAY,OAAO;AAC5C,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,+BAAE,QAAQ,2BAA2B,QAAQ,UAAW,cAAxD,EAAqE,WAAW,IAAI,GAAG,IAAG,IAAI,QAAQ;AAAA,UAC3I,SAAS,KAAP;AACA,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,oCAAoC,QAAQ,SAAS,SAAU,cAAe,IAAI,QAAQ;AAAA,UACxI;AAAA,QAEF,OAAO;AAEL,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,+DAAgE,cAAe,IAAI,QAAQ;AAAA,QACzI;AAEA;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,qBAAqB,IAAI;AAG/B,YAAI,CAAC,mBAAmB,WAAY,OAAO,mBAAmB,YAAY,YAAY,OAAO,mBAAmB,YAAY,UAAW;AACrI,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,6DAA8D,qBAAsB,IAAI,QAAQ;AAC5I;AAAA,QACF;AAGA,YAAI;AACF,gBAAM,MAAM,KAAK,mBAAmB,kBAAkB;AAAA,QACxD,SAAS,KAAP;AACA,cAAI,eAAe,SAAS,IAAI,SAAS;AACvC,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,IAAI,WAAY,qBAAsB,IAAI,QAAQ;AAAA,UAChG,OAAO;AACL,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,OAAQ,qBAAsB,IAAI,QAAQ;AAAA,UACxF;AACA;AAAA,QACF;AAGA,YAAI;AACF,cAAI,CAAC,IAAI,UAAU;AACjB,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,0BAA0B,mBAAmB,+BAAgC,qBAAsB,IAAI,QAAQ;AAC3J;AAAA,UACF;AACA,gBAAM,IAAI,KAAK,mBAAmB,OAAO;AACzC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,QAAQ,oBAAqB,qBAAsB,IAAI,QAAQ;AAAA,QACtG,SAAS,KAAP;AACA,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,0BAA0B,SAAU,qBAAsB,IAAI,QAAQ;AAAA,QACpH;AAEA;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,uBAAuB,IAAI;AAGjC,YAAI;AACF,gBAAM,MAAM,KAAK,mBAAmB,oBAAoB;AAAA,QAC1D,SAAS,KAAP;AACA,cAAI,eAAe,SAAS,IAAI,SAAS;AACvC,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,IAAI,WAAY,uBAAwB,IAAI,QAAQ;AAAA,UAClG,OAAO;AACL,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,OAAQ,uBAAwB,IAAI,QAAQ;AAAA,UAC1F;AACA;AAAA,QACF;AAGA,YAAI;AACF,cAAI,CAAC,IAAI,WAAW;AAClB,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,0BAA0B,qBAAqB,gCAAiC,uBAAwB,IAAI,QAAQ;AAChK;AAAA,UACF;AACA,gBAAM,IAAI,OAAO;AACjB,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,QAAQ,qBAAsB,uBAAwB,IAAI,QAAQ;AAAA,QACzG,SAAS,KAAP;AACA,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,2BAA2B,SAAU,uBAAwB,IAAI,QAAQ;AAAA,QACvH;AAEA;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,qBAAqB,IAAI;AAG/B,YAAI,OAAO,mBAAmB,UAAU,UAAU;AAChD,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,gCAAiC,qBAAsB,IAAI,QAAQ;AAC/G;AAAA,QACF;AAGA,YAAI;AACF,gBAAM,MAAM,KAAK,mBAAmB,kBAAkB;AAAA,QACxD,SAAS,KAAP;AACA,cAAI,eAAe,SAAS,IAAI,SAAS;AACvC,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,IAAI,WAAY,qBAAsB,IAAI,QAAQ;AAAA,UAChG,OAAO;AACL,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,OAAQ,qBAAsB,IAAI,QAAQ;AAAA,UACxF;AACA;AAAA,QACF;AAGA,YAAI;AACF,gBAAM,IAAI,MAAM,mBAAmB,KAAK;AACxC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,QAAQ,+BAAgC,qBAAsB,IAAI,QAAQ;AAAA,QACjH,SAAS,KAAP;AACA,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,qCAAqC,SAAU,qBAAsB,IAAI,QAAQ;AAAA,QAC/H;AAEA;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,8BAA8B,IAAI;AAGxC,YAAI,OAAO,4BAA4B,YAAY,YAAY,4BAA4B,UAAU,OAAO,4BAA4B,UAAU,KAAO;AACvJ,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,wDAAyD,8BAA+B,IAAI,QAAQ;AAChJ;AAAA,QACF;AACA,YAAI,OAAO,4BAA4B,QAAQ,YAAY,4BAA4B,MAAM,GAAG;AAC9F,sCAA4B,MAAM;AAAA,QACpC;AAGA,YAAI;AACF,gBAAM,MAAM,KAAK,mBAAmB,2BAA2B;AAAA,QACjE,SAAS,KAAP;AACA,cAAI,eAAe,SAAS,IAAI,SAAS;AACvC,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,IAAI,WAAY,8BAA+B,IAAI,QAAQ;AAAA,UACzG,OAAO;AACL,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,OAAQ,8BAA+B,IAAI,QAAQ;AAAA,UACjG;AACA;AAAA,QACF;AAGA,cAAM,oBAAoB,IAAI,wBAAwB;AAAA,UACpD,QAAQ,CAAC,WAAW,UAAM;AAxvEpC;AAwvEuC,yBAAK,OAAO,oBAAK,WAAL,oBAAa,SAAb,oBAAmB;AAAA;AAAA,UAC5D,KAAK,4BAA4B;AAAA,UACjC,MAAM,4BAA4B;AAAA,QACpC,CAAC;AACD,0BAAkB,GAAG,OAAO,CAAC,cAAc;AACzC,gBAAM,YAAY,UAAU,IAAI,CAAC,MAAO,GAAE,OAAO,EAAE,MAAM,MAAM,SAAS,EAAE,MAAM,IAAI,OAAO,EAAE,MAAM,MAAM,IAAI,CAAC,MAAO,GAAE,IAAI,EAAE,IAAI,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE;AAClJ,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,aAAc,8BAA+B,IAAI,QAAQ;AAAA,QAChG,CAAC;AAED;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,gCAAgC,IAAI;AAG1C,YAAI,OAAO,8BAA8B,kBAAkB,UAAU;AACnE,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,wCAAyC,gCAAiC,IAAI,QAAQ;AAClI;AAAA,QACF;AACA,YAAI,CAAC,8BAA8B,WAAY,OAAO,8BAA8B,YAAY,YAAY,OAAO,8BAA8B,YAAY,UAAW;AACtK,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,6DAA8D,gCAAiC,IAAI,QAAQ;AACvJ;AAAA,QACF;AAGA,YAAI;AACF,gBAAM,YAAY,MAAM,KAAK,qBAAqB,mBAAmB,8BAA8B,eAAe,8BAA8B,OAAO;AACvJ,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,+BAAE,QAAQ,gBAAiB,gCAA3B,EAA0D,UAAU,IAAG,IAAI,QAAQ;AAAA,QACxH,SAAS,KAAP;AACA,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,wBAAwB,SAAU,gCAAiC,IAAI,QAAQ;AAAA,QAC7H;AAEA;AAAA,WAEG;AAIH,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,qBAAqB,IAAI;AAG/B,YAAI,CAAC,mBAAmB,UAAU;AAChC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,8BAA+B,qBAAsB,IAAI,QAAQ;AAC7G;AAAA,QACF;AAEA,cAAM,eAAe,WAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,mBAAmB;AACtE,YAAI,CAAC,cAAc;AACjB,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,qBAAqB,mBAAmB,iBAAiB,GAAG,IAAI,QAAQ;AACpH;AAAA,QACF;AAEA,YAAI;AACF,gBAAM,aAAa,MAAM;AACzB,eAAK,IAAI,KAAK,eAAe,aAAa,SAAS,aAAa,KAAK;AAErE,cAAI,IAAI,UAAU;AAChB,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,QAAQ,KAAK,GAAG,IAAI,QAAQ;AAAA,UACnE;AAAA,QACF,SAAS,KAAP;AACA,cAAI,IAAI,UAAU;AAChB,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,wBAAwB,mBAAmB,aAAa,SAAU,qBAAsB,IAAI,QAAQ;AAAA,UAClJ;AAAA,QACF;AAEA;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,uBAAuB,IAAI;AAGjC,YAAI,CAAC,qBAAqB,UAAU;AAClC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,8BAA+B,uBAAwB,IAAI,QAAQ;AAC/G;AAAA,QACF;AAEA,cAAM,SAAS,WAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,qBAAqB;AAClE,YAAI,CAAC,QAAQ;AACX,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,qBAAqB,qBAAqB,oBAAqB,uBAAwB,IAAI,QAAQ;AAC/I;AAAA,QACF;AAEA,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS;AAAA,UACjC,IAAI,OAAO;AAAA,UACX,MAAM,OAAO;AAAA,UACb,aAAa,OAAO;AAAA,UACpB,SAAS,OAAO,QAAQ,MAAM,IAAI,CAAC,MAAO;AAAA,YACxC,IAAI,EAAE;AAAA,YACN,KAAK,EAAE,KAAK;AAAA,YACZ,aAAa,EAAE;AAAA,UACjB,EAAE;AAAA,UACF,OAAO,OAAO,MAAM,MAAM,IAAI,CAAC,MAAO;AAAA,YACpC,IAAI,EAAE;AAAA,YACN,MAAM,EAAE;AAAA,YACR,OAAO,EAAE;AAAA,UACX,EAAE;AAAA,UACF,UAAU,OAAO,SAAS,MAAM,IAAI,CAAC,MAAO;AAAA,YAC1C,IAAI,EAAE;AAAA,YACN,UAAU,EAAE;AAAA,YACZ,MAAM,EAAE;AAAA,YACR,MAAM,EAAE;AAAA,UACV,EAAE;AAAA,QACJ,GAAG,IAAI,QAAQ;AAEf;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,wBAAwB,IAAI;AAGlC,YAAI,CAAC,sBAAsB,YAAY,CAAC,sBAAsB,WAAW;AACvE,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,2CAA4C,wBAAyB,IAAI,QAAQ;AAC7H;AAAA,QACF;AAEA,kBAAU,iBAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,sBAAsB,cAApD,mBAA+D,SAAS,MAAM,IAAI,sBAAsB;AAClH,YAAI,CAAC,SAAS;AACZ,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,sBAAsB,sBAAsB,gCAAgC,sBAAsB,oBAAqB,wBAAyB,IAAI,QAAQ;AACxM;AAAA,QACF;AAEA,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS;AAAA,UACjC,IAAI,QAAQ;AAAA,UACZ,UAAU,QAAQ;AAAA,UAClB,MAAM,QAAQ;AAAA,UACd,MAAM,QAAQ;AAAA,UACd,SAAS,CAAC,QAAQ,SAAS,KAAK,QAAQ,QAAQ,IAAI,CAAC,MAAO;AAAA,YAC1D,IAAI,EAAE;AAAA,YACN,KAAK,EAAE,KAAK;AAAA,YACZ,aAAa,EAAE;AAAA,UACjB,EAAE;AAAA,QACJ,GAAG,IAAI,QAAQ;AAEf;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,6BAA6B,IAAI;AAGvC,YAAI,CAAC,2BAA2B,YAAa,CAAC,2BAA2B,UAAU,CAAC,2BAA2B,SAAU;AACvH,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,oDAAqD,6BAA8B,IAAI,QAAQ;AAC3I;AAAA,QACF;AAEA,YAAI;AACJ,YAAI,2BAA2B,QAAQ;AACrC,mBAAS,iBAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,2BAA2B,cAAzD,mBAAoE,QAAQ,MAAM,IAAI,2BAA2B;AAC1H,cAAI,CAAC,QAAQ;AACX,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,qBAAqB,2BAA2B,6BAA6B,2BAA2B,oBAAqB,6BAA8B,IAAI,QAAQ;AACnN;AAAA,UACF;AAAA,QACF,OAAO;AACL,mBAAS,iBAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,2BAA2B,cAAzD,mBAAoE,QAAQ,MAAM,KAAK,CAAC,MAAM,EAAE,KAAK,QAAQ,2BAA2B;AACjJ,cAAI,CAAC,QAAQ;AACX,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,sBAAsB,2BAA2B,8BAA8B,2BAA2B,oBAAqB,6BAA8B,IAAI,QAAQ;AACrN;AAAA,UACF;AAAA,QACF;AAEA,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS;AAAA,UACjC,IAAI,OAAO;AAAA,UACX,KAAK,OAAO,KAAK;AAAA,UACjB,aAAa,OAAO;AAAA,UACpB,cAAc,OAAO;AAAA,UACrB,kBAAkB,OAAO,iBAAiB;AAAA,UAC1C,OAAO,OAAO,MAAM,MAAM,IAAI,CAAC,MAAO;AAAA,YACpC,IAAI,EAAE;AAAA,YACN,MAAM,EAAE;AAAA,YACR,OAAO,EAAE;AAAA,UACX,EAAE;AAAA,UACF,UAAU,OAAO;AAAA,UACjB,gBAAgB,OAAO,MAAM;AAAA,UAC7B,YAAY,OAAO,MAAM;AAAA,UACzB,WAAW,OAAO,MAAM;AAAA,QAC1B,GAAG,IAAI,QAAQ;AAEf;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,qBAAqB,IAAI;AAG/B,YAAI,CAAC,mBAAmB,UAAU,CAAC,mBAAmB,SAAS;AAC7D,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,6BAA8B,qBAAsB,IAAI,QAAQ;AAC5G;AAAA,QACF;AAEA,YAAI,mBAAmB,QAAQ;AAC7B,iBAAO,WAAK,WAAL,mBAAa,MAAM,MAAM,IAAI,mBAAmB;AACvD,cAAI,CAAC,MAAM;AACT,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,mBAAmB,mBAAmB,kBAAmB,qBAAsB,IAAI,QAAQ;AACvI;AAAA,UACF;AAAA,QACF,OAAO;AACL,iBAAO,WAAK,WAAL,mBAAa,MAAM,MAAM,KAAK,CAAC,MAAM,EAAE,QAAQ,mBAAmB;AACzE,cAAI,CAAC,MAAM;AACT,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,oBAAoB,mBAAmB,mBAAoB,qBAAsB,IAAI,QAAQ;AACzI;AAAA,UACF;AAAA,QACF;AAEA,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS;AAAA,UACjC,IAAI,KAAK;AAAA,UACT,KAAK,KAAK;AAAA,UACV,WAAW,KAAK,UAAU;AAAA,UAC1B,KAAK,KAAK;AAAA,UACV,aAAa,KAAK;AAAA,QACpB,GAAG,IAAI,QAAQ;AAEf;AAAA,WAEG;AAIH,YAAI,CAAC,IAAI,UAAU;AACjB,eAAK,IAAI,KAAK,YAAY,IAAI,mCAAmC;AACjE;AAAA,QACF;AAEA,YAAI,OAAO,IAAI,YAAY,UAAU;AACnC,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,uCAAuC,GAAG,IAAI,QAAQ;AAClG;AAAA,QACF;AAEA,cAAM,wBAAwB,IAAI;AAElC,YAAI;AACF,gBAAM,MAAM,KAAK,mBAAmB,qBAAqB;AAAA,QAC3D,SAAS,KAAP;AACA,cAAI,eAAe,SAAS,IAAI,SAAS;AACvC,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,IAAI,WAAY,wBAAyB,IAAI,QAAQ;AAAA,UACnG,OAAO;AACL,iBAAK,OAAO,IAAI,MAAM,IAAI,SAAS,iBAAE,OAAO,OAAQ,wBAAyB,IAAI,QAAQ;AAAA,UAC3F;AACA;AAAA,QACF;AAEA,aAAK,OAAO,IAAI,MAAM,IAAI,SAAS;AAAA,UACjC,IAAI,IAAI;AAAA,UACR,QAAQ;AAAA,YACN,IAAI,IAAI,OAAO;AAAA,YACf,KAAK,IAAI,OAAO;AAAA,UAClB;AAAA,UACA,SAAS,IAAI;AAAA,UACb,QAAQ,IAAI,OAAO,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC;AAAA,UACxC,aAAa,IAAI,YAAY,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC;AAAA,UAClD,WAAW,IAAI,UAAU,MAAM,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC;AAAA,UACpD,kBAAkB,IAAI;AAAA,UACtB,iBAAiB,IAAI;AAAA,UACrB,WAAW,IAAI;AAAA,QACjB,GAAG,IAAI,QAAQ;AAEf;AAAA;AAMA,aAAK,IAAI,KAAK,qCAAqC,IAAI,SAAS;AAChE,YAAI,IAAI,UAAU;AAChB,eAAK,OAAO,IAAI,MAAM,IAAI,SAAS,EAAE,OAAO,oBAAoB,IAAI,UAAU,GAAG,IAAI,QAAQ;AAAA,QAC/F;AAAA;AAAA,EAGN;AAAA,EAeO,+BAAgC,SAAiC;AACtE,QAAI;AAEJ,QAAI,QAAQ,WAAW,GAAG,KAAK,QAAQ,SAAS,GAAG,GAAG;AAEpD,WAAK,IAAI,MAAM,0BAA0B;AAEzC,UAAI;AACF,aAAK,KAAK,MAAM,OAAO;AAAA,MACzB,SAAS,KAAP;AACA,cAAM,IAAI,MAAM,gDAAgD;AAAA,MAClE;AAGA,UAAK,CAAC,0BAAI,UAAS,CAAC,GAAG,WAAa,GAAG,SAAS,CAAC,MAAM,QAAQ,GAAG,KAAK,KAAO,GAAG,UAAU,CAAC,MAAM,QAAQ,GAAG,MAAM,GAAI;AACrH,cAAM,IAAI,MAAM,0CAA0C;AAAA,MAC5D;AAAA,IAEF,OAAO;AAEL,WAAK;AAAA,QACH;AAAA,MACF;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,QAOc,mBAAoB,YAA0D;AAvnF9F;AAwnFI,QAAI,CAAC,WAAW,WAAW;AACzB,YAAM,IAAI,MAAM,2BAA2B;AAAA,IAC7C;AAEA,QAAI,WAAW,UAAU,WAAW,SAAS;AAE3C,UAAI;AACJ,UAAI,WAAW,QAAQ;AAErB,eAAO,WAAK,WAAL,mBAAa,MAAM,MAAM,IAAI,WAAW;AAC/C,YAAI,CAAC,MAAM;AACT,gBAAM,IAAI,MAAM,uBAAuB,WAAW,cAAc;AAAA,QAClE;AAAA,MACF,OAAO;AAEL,eAAO,WAAK,WAAL,mBAAa,MAAM,MAAM,KAAK,CAAC,MAAM,EAAE,QAAQ,WAAW;AACjE,YAAI,CAAC,MAAM;AACT,gBAAM,IAAI,MAAM,wBAAwB,WAAW,eAAe;AAAA,QACpE;AAAA,MACF;AACA,UAAI;AACF,YAAI,CAAC,KAAK,WAAW;AACnB,gBAAM,KAAK,SAAS;AAAA,QACtB;AACA,cAAM,MAAM,YAAK,cAAL,mBAAgB,SAAS,MAAM,IAAI,WAAW,eAAc,MAAM,YAAK,cAAL,mBAAgB,SAAS,MAAM,WAAW;AACxH,YAAI,CAAC,KAAK;AACR,gBAAM,IAAI,MAAM,6BAA6B,WAAW,sBAAsB,KAAK,WAAW;AAAA,QAChG;AACA,eAAO;AAAA,MACT,SAAS,KAAP;AACA,cAAM,IAAI,MAAM,kCAAkC,KAAK,QAAQ,KAAK;AAAA,MACtE;AAAA,IAEF,WAAW,WAAW,YAAY,WAAW,WAAW;AAEtD,YAAM,UAAU,iBAAK,WAAL,mBAAa,OAAO,MAAM,IAAI,WAAW,cAAzC,mBAAoD,SAAS,MAAM,IAAI,WAAW;AAClG,UAAI,CAAC,oCAAS,WAAU;AACtB,cAAM,IAAI,MAAM,kCAAkC,WAAW,uBAAuB,WAAW,gBAAgB;AAAA,MACjH;AACA,UAAI;AACF,cAAM,MAAM,QAAQ,SAAS,MAAM,IAAI,WAAW,SAAS,KAAK,MAAM,QAAQ,SAAS,MAAM,WAAW,SAAS;AACjH,YAAI,CAAC,KAAK;AACR,gBAAM,IAAI,MAAM,6BAA6B,WAAW,yBAAyB,QAAQ,YAAY;AAAA,QACvG;AACA,eAAO;AAAA,MACT,SAAS,KAAP;AACA,cAAM,IAAI,MAAM,oCAAoC,QAAQ,SAAS,KAAK;AAAA,MAC5E;AAAA,IAEF,OAAO;AAEL,YAAM,IAAI,MAAM,2DAA2D;AAAA,IAC7E;AAAA,EACF;AAAA,EASO,uBAAwB,MAA0B,UAA4C;AACnG,QAAI,CAAC,KAAK,OAAO,qBAAqB;AACpC,aAAO;AAAA,IACT;AAGA,QAAI,QAA2D,KAAK,OAAO,gBAAgB,KAAK,CAAC,OAAO,GAAG,WAAW,KAAK,EAAE;AAG7H,QAAI,KAAK,OAAO,sBAAsB,SAAS,KAAK,gBAAgB,4BAAa;AAC/E,iBAAW,CAAC,EAAE,SAAS,KAAK,MAAM,OAAO;AACvC,cAAM,YAAY,KAAK,OAAO,sBAAsB,KAAK,CAAC,OAAO,GAAG,oBAAoB,GAAG,KAAK,MAAM,MAAM,KAAK,IAAI;AACrH,YAAI,WAAW;AACb,cAAI,CAAC,OAAO;AACV,oBAAQ;AAAA,UACV,OAAO;AACL,oBAAQ;AAAA,cACN,WAAY,MAAM,aAAa,UAAU;AAAA,cACzC,WAAY,MAAM,aAAa,UAAU;AAAA,cACzC,mBAAoB,MAAM,qBAAqB,UAAU;AAAA,cACzD,iBAAkB,MAAM,mBAAmB,UAAU;AAAA,YACvD;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAGA,QAAI,CAAC,OAAO;AACV,aAAO;AAAA,IACT;AAGA,QAAI,CAAC,UAAU;AACb,aAAO;AAAA,IACT;AAEA,QAAK,SAAS,aAAa,CAAC,MAAM,aAC1B,SAAS,aAAa,CAAC,MAAM,aAC7B,SAAS,qBAAqB,CAAC,MAAM,qBACrC,SAAS,mBAAmB,CAAC,MAAM,iBAAkB;AAC3D,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT;AAAA,EAQO,KAAM,MAA6B;AACxC,WAAO,IAAI,QAAQ,CAAC,YAAY,KAAK,WAAW,SAAS,IAAI,CAAC;AAAA,EAChE;AAAA,QAOc,uBAAwB,WAAoB,QAAiB,OAAsB;AAC/F,QAAI,SAAS,cAAc,KAAK,eAAe;AAC7C,YAAM,KAAK,cAAc,mBAAmB,WAAW,IAAI;AAC3D,WAAK,gBAAgB;AAAA,IACvB;AAAA,EACF;AAAA,QAUa,wBAAyB,IAAY,SAAiC,SAAmE;AACpJ,UAAM,YAAgD,KAAK,kBAAkB,IAAI,EAAE;AAEnF,QAAI,wCAAkB,WAAW,OAAO,GAAG;AACzC,aAAO,EAAE,GAAG;AAAA,IACd;AAEA,UAAM,MAAM,MAAM,KAAK,kBAAkB,IAAI,SAAS,OAAO;AAC7D,SAAK,kBAAkB,IAAI,IAAI,OAAO;AACtC,WAAO;AAAA,EACT;AAAA,QAMa,qBAAsB,IAAY,SAAoD;AACjG,QAAI,mCAAS,WAAW;AACtB,WAAK,kBAAkB,OAAO,CAAC,MAAM,QAAQ,IAAI,WAAW,EAAE,CAAC,EAAE,KAAK,CAAC,MAAM,QAAQ,KAAK,kBAAkB,OAAO,GAAG,CAAC;AAAA,IACzH,OAAO;AACL,WAAK,kBAAkB,OAAO,EAAE;AAAA,IAClC;AAEA,WAAO,KAAK,eAAe,IAAI,OAAO;AAAA,EACxC;AAAA,QAMc,SAAU,UAAqC;AAC3D,QAAI;AACF,WAAK,WAAW;AAEhB,YAAM,KAAK,uBAAuB,OAAO,IAAI;AAE7C,UAAI,KAAK,QAAQ;AACf,aAAK,OAAO,QAAQ;AAAA,MACtB;AAEA,eAAS;AAAA,IACX,SAAS,GAAP;AACA,eAAS;AAAA,IACX;AAAA,EACF;AAEF;AAppFgB;AAAA,EADd;AAAA,GACc,AA5EhB,eA4EgB;AAwPA;AAAA,EADd;AAAA,GACc,AApUhB,eAoUgB;AA83BA;AAAA,EADd;AAAA,GACc,AAlsChB,eAksCgB;AA2IA;AAAA,EADd;AAAA,GACc,AA70ChB,eA60CgB;AA6HN;AAAA,EADR;AAAA,GACQ,AA18CV,eA08CU;AAkBM;AAAA,EADd;AAAA,GACc,AA59ChB,eA49CgB;AA2WA;AAAA,EADd;AAAA,GACc,AAv0DhB,eAu0DgB;AAy4BA;AAAA,EADd;AAAA,GACc,AAhtFhB,eAgtFgB;AAkBhB,IAAI,QAAQ,SAAS,QAAQ;AAE3B,SAAO,UAAU,CAAC,YAAiD,IAAI,eAAe,OAAO;AAC/F,OAAO;AAEL,EAAC,OAAM,IAAI,eAAe,GAAG;AAC/B;",
  "names": []
}
